/* empty css             *//* empty css                   *//* empty css                  */import"./el-overlay-f7f710bd.js";/* empty css                  *//* empty css                     */import"./index-aae906bf.js";/* empty css                *//* empty css                    */import{E as A,b as L}from"./el-radio-c9a1047c.js";/* empty css                 */import{t as l}from"./index-5f4ce139.js";import{i as M,j as O,k as $,l as G}from"./sys-aa893c6b.js";import{d as K}from"./common-465e36b3.js";import{E as z}from"./index-95693143.js";import{a as H,E as J}from"./index-624573cc.js";import{E as Q}from"./index-470ade69.js";import{E as W}from"./index-50442f97.js";import{E as X}from"./index-2f0b1bf3.js";import{E as Y}from"./index-4862d1b3.js";import{E as Z}from"./index-4683bff4.js";import{v as ee}from"./directive-a07a10ed.js";import{d as le,r as m,w as ae,ab as oe,M as te,c as se,b as C,m as x,p as s,f as R,q as o,v as _,x as v,u as t,L as re}from"./runtime-core.esm-bundler-7c3fd514.js";const ne={class:"dialog-footer"},Be=le({__name:"edit-role",emits:["complete"],setup(ue,{expose:D,emit:N}){const i=m(!1),d=m(!1);let b="";const h=m([]);M().then(n=>{h.value=n.data});const c=m(!1),g=m(!1),p=m(null);ae(c,()=>{c.value?p.value.setCheckedNodes(oe(h.value)):p.value.setCheckedNodes([])});const U=K(n=>{a.rules=p.value.getCheckedKeys()}),E={role_id:0,role_name:"",status:1,rules:[]},a=te({...E}),V=m(),F=se(()=>({role_name:[{required:!0,message:l("roleNamePlaceholder"),trigger:"blur"}],rules:[{validator:(n,e,u)=>{e.length?u():u(new Error(l("rulesPlaceholder")))},trigger:"blur"}]})),S=async n=>{if(d.value||!n)return;const e=a.role_id?O:$;await n.validate(async u=>{u&&(d.value=!0,e(a).then(k=>{d.value=!1,i.value=!1,N("complete")}).catch(()=>{d.value=!1,i.value=!1}))})};return D({showDialog:i,setFormData:async(n=null)=>{if(d.value=!0,c.value=!1,Object.assign(a,E),b=l("addRole"),n){b=l("updateRole");const e=await(await G(n.role_id)).data;Object.keys(a).forEach(u=>{e[u]!=null&&(a[u]=e[u])})}d.value=!1}}),(n,e)=>{const u=z,f=H,k=A,B=L,y=Q,j=W,I=X,P=J,w=Y,T=Z,q=ee;return C(),x(T,{modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=r=>i.value=r),title:t(b),width:"500px","destroy-on-close":!0},{footer:s(()=>[R("span",ne,[o(w,{onClick:e[4]||(e[4]=r=>i.value=!1)},{default:s(()=>[_(v(t(l)("cancel")),1)]),_:1}),o(w,{type:"primary",loading:d.value,onClick:e[5]||(e[5]=r=>S(V.value))},{default:s(()=>[_(v(t(l)("confirm")),1)]),_:1},8,["loading"])])]),default:s(()=>[re((C(),x(P,{model:a,"label-width":"90px",ref_key:"formRef",ref:V,rules:t(F),class:"page-form"},{default:s(()=>[o(f,{label:t(l)("roleName"),prop:"role_name"},{default:s(()=>[o(u,{modelValue:a.role_name,"onUpdate:modelValue":e[0]||(e[0]=r=>a.role_name=r),placeholder:t(l)("roleNamePlaceholder"),clearable:"",disabled:a.uid,class:"input-width",maxlength:"10","show-word-limit":!0},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),o(f,{label:t(l)("status")},{default:s(()=>[o(B,{modelValue:a.status,"onUpdate:modelValue":e[1]||(e[1]=r=>a.status=r)},{default:s(()=>[o(k,{label:1},{default:s(()=>[_(v(t(l)("startUsing")),1)]),_:1}),o(k,{label:0},{default:s(()=>[_(v(t(l)("statusDeactivate")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(f,{label:t(l)("permission"),prop:"rules"},{default:s(()=>[R("div",null,[o(y,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=r=>c.value=r),label:t(l)("selectAll")},null,8,["modelValue","label"]),o(y,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=r=>g.value=r),label:t(l)("checkStrictly")},null,8,["modelValue","label"])]),o(I,{"max-height":"40vh",class:"w-full"},{default:s(()=>[o(j,{data:h.value,props:{label:"menu_name"},"default-checked-keys":a.rules,"check-strictly":g.value,"show-checkbox":"","default-expand-all":"",onCheckChange:t(U),"node-key":"menu_key",ref_key:"treeRef",ref:p},null,8,["data","default-checked-keys","check-strictly","onCheckChange"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[q,d.value]])]),_:1},8,["modelValue","title"])}}});export{Be as _};
