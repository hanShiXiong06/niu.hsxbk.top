import"./base-0e92f4db.js";/* empty css                   *//* empty css                */import{a as z,E as j}from"./el-form-item-c2dd2ffe.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{M as O}from"./index-fac59425.js";/* empty css                  *//* empty css                  */import{_ as Z}from"./index-48a4e5ef.js";import{t as e}from"./index-2d1c7ba3.js";import{a as G,b as K,c as H,e as J,d as Q}from"./tools-2d9c0188.js";import{u as W,a as X}from"./vue-router-8b032575.js";import{E as Y}from"./index-a31d0a55.js";import{a as ee}from"./index-e9d9b1a1.js";import{E as le}from"./index-8cefa3ab.js";import{E as te}from"./index-e09a20f5.js";import{a as oe,E as ae}from"./index-757074f4.js";import{E as re}from"./index-2668a8ea.js";import{v as se}from"./directive-c6f70b8e.js";import{d as pe,r as _,o as ne,L as de,b as m,e as g,f as s,u as t,x as u,q as r,p,m as y,v as P,C as x,F as w,t as D}from"./runtime-core.esm-bundler-67034826.js";import"./index-72686045.js";import"./event-a537c4cb.js";import"./common-46715e7e.js";import"./index-81f2aa1e.js";import"./el-main-7a89c415.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-ebd2990f.js";import"./el-overlay-3eff2fc5.js";import"./index-defed8ff.js";import"./focus-trap-83769a43.js";import"./index-6cae7119.js";import"./index-d87ae4a2.js";import"./index-ef31373f.js";import"./index-de22cd40.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-17d8e4dc.js";import"./attachment-f90dcf10.js";/* empty css                      *//* empty css                    *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                    *//* empty css                   */import"./index-8c8d61e8.js";import"./index-434046cb.js";import"./index-d23c70b3.js";import"./index-2b1dc445.js";import"./index-c7745eb3.js";import"./debounce-f6ba9d12.js";import"./position-c2e84b2a.js";import"./index-0caa5b89.js";import"./index-fd563016.js";import"./isEqual-97c7f2d5.js";import"./index-95382bd9.js";import"./aria-adfa05c5.js";import"./validator-9409f909.js";import"./index-66750d66.js";import"./strings-1130dd70.js";import"./index-c6aa1547.js";const ie={class:"main-container mb-80"},ue={class:"detail-head !mb-[10px]"},me=s("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1),ce={class:"ml-[1px]"},ve=s("span",{class:"adorn"},"|",-1),_e={class:"right"},ge={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},he={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},fe={class:"text-[12px] text-[#a9a9a9] leading-normal"},ye={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},xe={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},be={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},Ve={class:"text-[12px] text-[#a9a9a9] leading-normal"},ke={key:0,class:"fixed-footer-wrap"},Pe={class:"fixed-footer"},$l=pe({__name:"edit",setup(we){const v=W(),b=X(),F=v.meta.title,o=_({title:"",icon:"",key:"",desc:"",author:"",version:"",cover:"",type:"",support_app:"",support_type:1}),E=_([]),c=_(!1),A=_(),L=(i,l,n)=>l!==""?/^[a-zA-Z][a-zA-Z0-9_]*$/.test(l)?n():n(new Error(e("keyPlaceholderErr"))):n(new Error(e("keyPlaceholder"))),T=(i,l,n)=>l!==""?/^([0-9]\d|[0-9])(\.([0-9]){1}){2}$/.test(l)?n():n(new Error(e("versionPlaceholderErr"))):n(new Error(e("versionPlaceholder"))),B=_({title:[{required:!0,message:e("titlePlaceholder"),trigger:"blur"}],icon:[{required:!0,message:e("iconPlaceholder"),trigger:"change"}],key:[{required:!0,validator:L,trigger:"blur"}],author:[{required:!0,message:e("authorPlaceholder"),trigger:"blur"}],version:[{required:!0,validator:T,trigger:"blur"}],cover:[{required:!0,message:e("coverPlaceholder"),trigger:"change"}],type:[{required:!0,message:e("typePlaceholder"),trigger:"change"}],support_app:[{required:!0,message:e("typePlaceholder"),trigger:"change"}]});ne(async()=>{let i=await G();E.value=i.data,v.query.key&&N(v.query.key)});const q=()=>{o.value.support_app=""},N=i=>{c.value=!0,K(i).then(l=>{o.value=Object.assign(o.value,l.data),c.value=!1}).catch(()=>{c.value=!1})},C=_([]);(async()=>{let{data:i}=await O();C.value=i})();const $=i=>{H(i).then(l=>{Y.alert(l.data?e("warningText"):e("successText"),e("warning"),{confirmButtonText:e("confirm"),callback:n=>{console.log(n)}})})},S=async i=>{await i.validate(async l=>{if(l){let n=v.query.key?J:Q;c.value=!0,n(o.value.key,o.value).then(d=>{c.value=!1,ee({message:e("onSaveSuccessText"),type:"success"}),setTimeout(()=>{window.addonActiveName="pluginList",b.push({path:"/tools/addon"})},650)}).catch(()=>{c.value=!1})}})};return(i,l)=>{const n=le,d=z,U=Z,V=te,h=oe,k=ae,I=j,M=re,R=se;return de((m(),g("div",ie,[s("div",ue,[s("div",{class:"left",onClick:l[0]||(l[0]=a=>t(b).push({path:"/tools/addon"}))},[me,s("span",ce,u(t(e)("returnToPreviousPage")),1)]),ve,s("span",_e,u(t(F)),1)]),r(M,{class:"box-card !border-none",shadow:"never"},{default:p(()=>[r(I,{model:o.value,"label-width":"90px",ref_key:"formRef",ref:A,rules:B.value,class:"page-form"},{default:p(()=>[r(d,{label:t(e)("title"),prop:"title"},{default:p(()=>[r(n,{modelValue:o.value.title,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.title=a),clearable:"",placeholder:t(e)("titlePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(d,{label:t(e)("icon"),prop:"icon"},{default:p(()=>[s("div",null,[r(U,{modelValue:o.value.icon,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.icon=a)},null,8,["modelValue"]),s("p",ge,u(t(e)("iconPlaceholder1")),1)])]),_:1},8,["label"]),r(d,{label:t(e)("key"),prop:"key"},{default:p(()=>[s("div",null,[r(n,{modelValue:o.value.key,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.key=a),clearable:"",disabled:t(v).query.key,placeholder:t(e)("keyPlaceholder"),class:"input-width mr-[15px]"},null,8,["modelValue","disabled","placeholder"]),t(v).query.key?x("",!0):(m(),y(V,{key:0,type:"primary",disabled:o.value.key=="",onClick:l[4]||(l[4]=a=>$(o.value.key))},{default:p(()=>[P("官方市场标识检测")]),_:1},8,["disabled"])),s("p",he,u(t(e)("keyPlaceholder1")),1),s("p",fe,u(t(e)("keyPlaceholder2")),1)])]),_:1},8,["label"]),r(d,{label:t(e)("desc"),prop:"desc"},{default:p(()=>[r(n,{type:"textarea",modelValue:o.value.desc,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.desc=a),clearable:"",placeholder:t(e)("descPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(d,{label:t(e)("author"),prop:"author"},{default:p(()=>[r(n,{modelValue:o.value.author,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.author=a),clearable:"",placeholder:t(e)("authorPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(d,{label:t(e)("version"),prop:"version"},{default:p(()=>[s("div",null,[r(n,{modelValue:o.value.version,"onUpdate:modelValue":l[7]||(l[7]=a=>o.value.version=a),clearable:"",placeholder:t(e)("versionPlaceholder"),class:"input-width",onkeyup:"this.value = this.value.replace(/[^\\d\\.]/g,'');"},null,8,["modelValue","placeholder"]),s("p",ye,u(t(e)("versionPlaceholder1")),1)])]),_:1},8,["label"]),r(d,{label:t(e)("cover"),prop:"cover"},{default:p(()=>[s("div",null,[r(U,{modelValue:o.value.cover,"onUpdate:modelValue":l[8]||(l[8]=a=>o.value.cover=a)},null,8,["modelValue"]),s("p",xe,u(t(e)("coverPlaceholder1")),1)])]),_:1},8,["label"]),r(d,{label:t(e)("type"),prop:"type"},{default:p(()=>[s("div",null,[r(k,{modelValue:o.value.type,"onUpdate:modelValue":l[9]||(l[9]=a=>o.value.type=a),placeholder:t(e)("typePlaceholder"),class:"input-width",clearable:"",onChange:q},{default:p(()=>[(m(!0),g(w,null,D(E.value,(a,f)=>(m(),y(h,{key:f,label:a,value:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),s("p",be,u(t(e)("typePlaceholder1")),1),s("p",Ve,u(t(e)("typePlaceholder2")),1)])]),_:1},8,["label"]),o.value.type==="addon"?(m(),g(w,{key:0},[r(d,{label:t(e)("supportType")},{default:p(()=>[s("div",null,[r(k,{modelValue:o.value.support_type,"onUpdate:modelValue":l[10]||(l[10]=a=>o.value.support_type=a),class:"input-width",onChange:q},{default:p(()=>[r(h,{label:"通用插件",value:1}),r(h,{label:"支持应用",value:2})]),_:1},8,["modelValue"])])]),_:1},8,["label"]),o.value.support_type!=1?(m(),y(d,{key:0,label:t(e)("supportApp"),prop:"support_app"},{default:p(()=>[r(k,{modelValue:o.value.support_app,"onUpdate:modelValue":l[11]||(l[11]=a=>o.value.support_app=a),placeholder:t(e)("supportAppPlaceholder"),class:"input-width"},{default:p(()=>[(m(!0),g(w,null,D(C.value,(a,f)=>(m(),y(h,{label:a.title,value:a.key,key:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):x("",!0)],64)):x("",!0)]),_:1},8,["model","rules"])]),_:1}),c.value?x("",!0):(m(),g("div",ke,[s("div",Pe,[r(V,{type:"primary",onClick:l[12]||(l[12]=a=>S(A.value))},{default:p(()=>[P(u(t(e)("GeneratePlugins")),1)]),_:1}),r(V,{onClick:l[13]||(l[13]=a=>t(b).push({path:"/tools/addon"}))},{default:p(()=>[P(u(t(e)("cancel")),1)]),_:1})])]))])),[[R,c.value]])}}});export{$l as default};
