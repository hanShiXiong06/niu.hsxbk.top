import{g as B,r as f,a4 as C,j as V,m as p,D as c,E as i,q as R,F as d,c as E,K as P,L as x,u as o,a1 as Y,n as j,I as G,J as O,T as w}from"./base-45eb5090.js";/* empty css                   */import{E as H}from"./el-overlay-616d6124.js";/* empty css                  *//* empty css                     *//* empty css                       *//* empty css                 */import"./index-ad71a852.js";import"./el-tooltip-58212670.js";/* empty css               *//* empty css                  *//* empty css                  */import{t as a}from"./index-3694a2b2.js";import{n as M,o as A,p as J,q as K}from"./site-1a478ebf.js";import{E as $}from"./index-4ce9333e.js";import{a as z,E as Q}from"./index-2bfbe5a7.js";import{a as W,E as X}from"./index-cc9a73f0.js";import{E as Z}from"./index-91e87b83.js";import{E as ee}from"./index-25c37860.js";import{v as ae}from"./directive-9f485fe5.js";const le={class:"dialog-footer"},ye=B({__name:"edit-site",emits:["complete"],setup(re,{expose:y,emit:D}){let u=f(!1);const s=f(!0);let _=f([]);const v={site_id:"",site_name:"",real_name:"",username:"",password:"",confirm_password:"",expire_time:"",group_id:""},l=C({...v}),b=f();(async()=>{_.value=await(await M({})).data,_.value.length>0&&(l.group_id=_.value[0].group_id)})();const k=async(m=null)=>{if(s.value=!0,Object.assign(l,v),m){const e=await(await A(m.site_id)).data;Object.keys(l).forEach(t=>{e[t]!=null&&(l[t]=e[t])})}s.value=!1},q=V(()=>({site_name:[{required:!0,message:a("siteNamePlaceholder"),trigger:"blur"}],group_id:[{required:!0,message:a("groupIdPlaceholder"),trigger:"blur"}],username:[{required:!0,message:a("usernamePlaceholder"),trigger:"blur"}],password:[{required:!0,message:a("passwordPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:a("userRealNamePlaceholder"),trigger:"blur"}],confirm_password:[{required:!0,message:a("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(m,e,t)=>{e!=l.password?t(new Error(a("confirmPasswordError"))):t()},trigger:"blur"}],expire_time:[{required:!0,message:a("expireTimePlaceholder"),trigger:"blur"}]})),N=V(()=>(f(""),s.value?"":l.site_id?a("editSite"):a("addSite"))),S=async m=>{s.value||!m||await m.validate(async e=>{if(e){s.value=!0;let t=l;(t.site_id?J:K)(t).then(g=>{s.value=!1,u.value=!1,D("complete")}).catch(g=>{s.value=!1})}})};return y({showDialog:u,setFormData:k,loading:s}),(m,e)=>{const t=$,n=z,g=W,I=X,U=Z,F=Q,h=ee,L=H,T=ae;return p(),c(L,{modelValue:o(u),"onUpdate:modelValue":e[8]||(e[8]=r=>E(u)?u.value=r:u=r),title:o(N),width:"500px","destroy-on-close":!0},{footer:i(()=>[R("span",le,[d(h,{onClick:e[6]||(e[6]=r=>E(u)?u.value=!1:u=!1)},{default:i(()=>[P(x(o(a)("cancel")),1)]),_:1}),d(h,{type:"primary",loading:s.value,onClick:e[7]||(e[7]=r=>S(b.value))},{default:i(()=>[P(x(o(a)("confirm")),1)]),_:1},8,["loading"])])]),default:i(()=>[Y((p(),c(F,{model:l,"label-width":"90px",ref_key:"formRef",ref:b,rules:o(q),class:"page-form"},{default:i(()=>[d(n,{label:o(a)("siteName"),prop:"site_name"},{default:i(()=>[d(t,{modelValue:l.site_name,"onUpdate:modelValue":e[0]||(e[0]=r=>l.site_name=r),clearable:"",placeholder:o(a)("siteNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(n,{label:o(a)("groupId"),prop:"group_id"},{default:i(()=>[d(I,{modelValue:l.group_id,"onUpdate:modelValue":e[1]||(e[1]=r=>l.group_id=r),clearable:"",placeholder:o(a)("groupIdPlaceholder"),class:"input-width"},{default:i(()=>[(p(!0),j(G,null,O(o(_),r=>(p(),c(g,{label:r.group_name,value:r.group_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),!l.site_id&&!s.value?(p(),c(n,{key:0,label:o(a)("username"),prop:"username"},{default:i(()=>[d(t,{modelValue:l.username,"onUpdate:modelValue":e[2]||(e[2]=r=>l.username=r),clearable:"",placeholder:o(a)("usernamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),!l.site_id&&!s.value?(p(),c(n,{key:1,label:o(a)("password"),prop:"password"},{default:i(()=>[d(t,{modelValue:l.password,"onUpdate:modelValue":e[3]||(e[3]=r=>l.password=r),clearable:"",placeholder:o(a)("passwordPlaceholder"),class:"input-width","show-password":!0,type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),!l.site_id&&!s.value?(p(),c(n,{key:2,label:o(a)("confirmPassword"),prop:"confirm_password"},{default:i(()=>[d(t,{modelValue:l.confirm_password,"onUpdate:modelValue":e[4]||(e[4]=r=>l.confirm_password=r),placeholder:o(a)("confirmPasswordPlaceholder"),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),d(n,{label:o(a)("expireTime"),prop:"expire_time",class:"input-width"},{default:i(()=>[d(U,{class:"flex-1 !flex",modelValue:l.expire_time,"onUpdate:modelValue":e[5]||(e[5]=r=>l.expire_time=r),clearable:"",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:o(a)("expireTimePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[T,s.value]])]),_:1},8,["modelValue","title"])}}});export{ye as _};
