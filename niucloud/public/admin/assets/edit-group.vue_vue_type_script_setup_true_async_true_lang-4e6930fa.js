/* empty css             *//* empty css                   *//* empty css                  */import"./el-overlay-f7f710bd.js";/* empty css                  *//* empty css                     */import"./index-aae906bf.js";/* empty css                *//* empty css                    *//* empty css                 */import{t as o}from"./index-5f4ce139.js";import{o as T}from"./sys-aa893c6b.js";import{f as j,h as q,i as A}from"./site-ceac4417.js";import{d as L}from"./common-465e36b3.js";import{E as M}from"./index-95693143.js";import{a as O,E as $}from"./index-624573cc.js";import{E as K}from"./index-470ade69.js";import{E as z}from"./index-50442f97.js";import{E as H}from"./index-2f0b1bf3.js";import{E as J}from"./index-4862d1b3.js";import{E as Q}from"./index-4683bff4.js";import{v as W}from"./directive-a07a10ed.js";import{d as X,r as p,w as Y,ab as Z,M as ee,c as le,b as y,m as V,p as n,f as E,q as s,v as x,x as C,u as a,L as oe}from"./runtime-core.esm-bundler-7c3fd514.js";const ae={class:"dialog-footer"},Re=X({__name:"edit-group",emits:["complete"],setup(te,{expose:D,emit:N}){const m=p(!1),d=p(!1);let _="";const g=p([]);T("site").then(u=>{g.value=u.data});const i=p(!1),v=p(!1),c=p(null);Y(i,()=>{i.value?c.value.setCheckedNodes(Z(g.value)):c.value.setCheckedNodes([])});const R=L(u=>{l.group_roles=c.value.getCheckedKeys()}),b={group_id:0,group_name:"",group_desc:"",group_roles:[]},l=ee({...b}),k=p(),S=le(()=>({group_name:[{required:!0,message:o("groupNamePlaceholder"),trigger:"blur"}],group_roles:[{validator:(u,e,t)=>{e.length?t():t(new Error(o("groupRolesPlaceholder")))},trigger:"blur"}]})),F=async u=>{if(d.value||!u)return;const e=l.group_id?j:q;await u.validate(async t=>{t&&(d.value=!0,e(l).then(h=>{d.value=!1,m.value=!1,N("complete")}).catch(()=>{d.value=!1,m.value=!1}))})};return D({showDialog:m,setFormData:async(u=null)=>{if(d.value=!0,i.value=!1,Object.assign(l,b),_=o("addGroup"),u){_=o("updateGroup");const e=await(await A(u.group_id)).data;Object.keys(l).forEach(t=>{e[t]!=null&&(l[t]=e[t])})}d.value=!1}}),(u,e)=>{const t=M,f=O,h=K,G=z,U=H,B=$,w=J,P=Q,I=W;return y(),V(P,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=r=>m.value=r),title:a(_),width:"500px","destroy-on-close":!0},{footer:n(()=>[E("span",ae,[s(w,{onClick:e[4]||(e[4]=r=>m.value=!1)},{default:n(()=>[x(C(a(o)("cancel")),1)]),_:1}),s(w,{type:"primary",loading:d.value,onClick:e[5]||(e[5]=r=>F(k.value))},{default:n(()=>[x(C(a(o)("confirm")),1)]),_:1},8,["loading"])])]),default:n(()=>[oe((y(),V(B,{model:l,"label-width":"90px",ref_key:"formRef",ref:k,rules:a(S),class:"page-form"},{default:n(()=>[s(f,{label:a(o)("groupName"),prop:"group_name"},{default:n(()=>[s(t,{modelValue:l.group_name,"onUpdate:modelValue":e[0]||(e[0]=r=>l.group_name=r),placeholder:a(o)("groupNamePlaceholder"),clearable:"",disabled:l.uid,class:"input-width",maxlength:"20","show-word-limit":!0},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),s(f,{label:a(o)("groupDesc"),prop:"group_desc"},{default:n(()=>[s(t,{modelValue:l.group_desc,"onUpdate:modelValue":e[1]||(e[1]=r=>l.group_desc=r),type:"textarea",rows:"4",clearable:"",placeholder:a(o)("groupDescPlaceholder"),class:"input-width",maxlength:"100"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(f,{label:a(o)("permission"),prop:"group_roles"},{default:n(()=>[E("div",null,[s(h,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=r=>i.value=r),label:a(o)("selectAll")},null,8,["modelValue","label"]),s(h,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=r=>v.value=r),label:a(o)("checkStrictly")},null,8,["modelValue","label"])]),s(U,{"max-height":"40vh",class:"w-full"},{default:n(()=>[s(G,{data:g.value,props:{label:"menu_name"},"default-checked-keys":l.group_roles,"check-strictly":v.value,"show-checkbox":"","default-expand-all":"",onCheckChange:a(R),"node-key":"menu_key",ref_key:"treeRef",ref:c},null,8,["data","default-checked-keys","check-strictly","onCheckChange"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[I,d.value]])]),_:1},8,["modelValue","title"])}}});export{Re as _};
