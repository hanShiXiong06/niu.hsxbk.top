/* empty css             *//* empty css                *//* empty css                   */import{g as Q,v as W}from"./index-aae906bf.js";/* empty css                  */import{_ as G}from"./edit-article-b70a4898.js";import{_ as K}from"./edit-graphic-nav-bb68e4c8.js";import{_ as X}from"./edit-horz-blank-3d00da2f.js";import{_ as Y}from"./edit-image-ads-a3ecef13.js";import{_ as Z}from"./edit-member-info-39212d3b.js";import{_ as ee}from"./edit-page-fea1003a.js";import{_ as te}from"./edit-text-82f3124e.js";import{v as oe}from"./error-492b6a5b.js";import{t as p}from"./index-5f4ce139.js";import{i as ne,u as ae,a as ie}from"./diy-c368a995.js";import{u as le,a as se}from"./vue-router-b5675730.js";import{u as re}from"./diy-89488517.js";import{f as pe}from"./common-465e36b3.js";import{c as ce}from"./cloneDeep-f98af5ea.js";import{E as me}from"./index-548a7823.js";import{E as de}from"./index-868cd458.js";import{E as ue}from"./index-4862d1b3.js";import{a as _e,E as fe}from"./index-622b5dd6.js";import{E as ve}from"./index-2f0b1bf3.js";import{E as ge}from"./index-cf47f151.js";import{E as xe}from"./index-acd12562.js";import{d as he,r as y,M as B,ab as d,w as ye,o as be,Q as Ce,b as f,e as w,q as n,p as s,f as i,x as u,u as o,v as T,F as $,t as z,m as J,L as we,U as ke,as as Ee,at as Se}from"./runtime-core.esm-bundler-7c3fd514.js";import{_ as Ne}from"./_plugin-vue_export-helper-c27b6911.js";import"./el-overlay-f7f710bd.js";import"./plugin-vue_export-helper-edbdb6f8.js";import"./index-f02197a7.js";import"./event-9519ab40.js";import"./focus-trap-bb1e8c7a.js";import"./index-7b0897f9.js";import"./el-switch-3d36d31d.js";import"./index-95693143.js";import"./index-2083be2e.js";import"./index-a3cf5375.js";import"./index-47617222.js";import"./validator-62f68fe3.js";/* empty css                 */import"./el-radio-c9a1047c.js";import"./el-avatar-7d17482e.js";import"./index-be5dc120.js";/* empty css                   *//* empty css                  *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                    *//* empty css                     *//* empty css                  *//* empty css                        */import"./article-a302dda6.js";import"./index-a9458a49.js";import"./_Uint8Array-de4f83bb.js";import"./_initCloneObject-bc5ed9bb.js";import"./index-470ade69.js";import"./isEqual-f40f939e.js";import"./flatten-b3585bb8.js";import"./_isIterateeCall-7a6fae02.js";import"./index-624573cc.js";import"./_baseClone-cf40e5b2.js";import"./index-96ef7065.js";import"./index-24c7fcee.js";import"./index-6ed8f3b9.js";import"./index-f97852b4.js";import"./index-800b62de.js";import"./index-9fbce820.js";import"./index-2804b007.js";import"./index-4683bff4.js";import"./index-c656f08b.js";import"./directive-a07a10ed.js";import"./index.vue_vue_type_script_setup_true_lang-7ed1b508.js";import"./index-82132406.js";import"./index.vue_vue_type_style_index_0_lang-a42d8a18.js";import"./attachment-51c3470b.js";/* empty css                    *//* empty css                   */import"./index-be5868d6.js";import"./sys-aa893c6b.js";import"./index-9bac81c5.js";import"./index-381e0c1f.js";import"./sortable.esm-47728b3c.js";import"./common-cc37bda4.js";import"./common-2cf17469.js";const qe=b=>(Ee("data-v-2e77ff98"),b=b(),Se(),b),Ie={class:"main-container flex-1"},De={class:"pl-[5px]"},Oe={class:"text-white ml-[10px] flex items-center"},Be={class:"mr-[5px]"},Te=qe(()=>i("div",{class:"flex-1"},null,-1)),$e={class:"full-container flex flex-row flex-1 bg-page"},ze={class:"component-list w-[290px]"},Je={class:"flex flex-row flex-wrap"},je=["title","onClick"],Le={class:"block text-base truncate"},Me={class:"preview-wrap flex-1 relative mt-[20px]"},Pe={class:"diy-view-wrap w-[375px] shadow-lg mx-auto"},Re={class:"text-base block text-center truncate cursor-pointer h-[64px] leading-[84px]"},Ue={class:"preview-block relative"},Fe={class:"quick-action absolute text-center -right-[70px] top-[20px] w-[42px] rounded shadow-md"},Ve=["src"],Ae={class:"edit-attribute-wrap w-[400px]"},He={class:"card-header flex justify-between items-center"},Qe={class:"title flex-1"},We=he({__name:"edit",setup(b){const e=re(),c=le(),k=se(),E=y(""),S=y([]),q=B([]),I=y(q),j=l=>{};c.query.id=c.query.id||0,c.query.name=c.query.name||"",c.query.type=c.query.type||"",c.query.title=c.query.title||"";const v=B({id:e.id,name:e.name,title:e.global.title,value:JSON.stringify({global:d(e.global),value:d(e.value)})}),D=y(!0),L=()=>{D.value?k.push("/diy/list"):me.confirm(p("leavePageTitleTips"),p("leavePageContentTips"),{confirmButtonText:p("confirm"),cancelButtonText:p("cancel"),type:"warning",autofocus:!1}).then(()=>{k.push("/diy/list")}).catch(()=>{})},M=Object.assign({"./components/edit-article.vue":G,"./components/edit-graphic-nav.vue":K,"./components/edit-horz-blank.vue":X,"./components/edit-image-ads.vue":Y,"./components/edit-member-info.vue":Z,"./components/edit-page.vue":ee,"./components/edit-text.vue":te}),O={};for(const[l,t]of Object.entries(M)){const x=l.replace(/^\.\/(.*)\.\w+$/,"$1").split("/")[1];O[x]=t.default}ye(()=>e,(l,t)=>{let r={id:l.id,name:l.name,title:l.global.title,value:JSON.stringify({global:d(l.global),value:d(l.value)})};e.postMessage(),D.value=JSON.stringify(r)==JSON.stringify(v)},{deep:!0}),ne({id:c.query.id,name:c.query.name,type:c.query.type,title:c.query.title}).then(l=>{if(l.code==200){let t=l.data;if(e.id=t.id||0,e.name=t.name,e.type=t.type,e.typeName=t.type_name,t.value){let r=JSON.parse(t.value);e.global=r.global,r.value.length&&(e.value=r.value)}else e.global.title=t.title;v.id=e.id,v.name=e.name,v.title=e.global.title,v.value=JSON.stringify({global:d(e.global),value:d(e.value)}),S.value=t.component,S.value.forEach(r=>{q.push(r.type),r.list.forEach(x=>{let a=ce(x);a.id=e.generateRandom(),a.componentName=a.name,a.componentTitle=a.title,a.maxCount=a.max_count,Object.assign(a,a.value),delete a.name,delete a.title,delete a.value,delete a.type,delete a.icon,delete a.max_count,e.components.push(a)})}),E.value=`${pe()}/${t.page}?mode=decorate`}}),be(()=>{window.previewIframe=document.getElementById("previewIframe")}),window.addEventListener("message",l=>{try{let t=JSON.parse(l.data);if(!t.type)return;switch(t.type){case"init":e.load=!0,e.postMessage();break;case"change":e.changeCurrentIndex(t.index,t.component);break;case"data":e.changeCurrentIndex(t.index,t.component),e.global=t.global,e.value=t.value;break}}catch(t){console.log("后台接受数据错误",t)}},!1);const g=y(!1),P=()=>{if(!e.verify()||g.value)return;g.value=!0;let l={id:e.id,name:e.name,title:e.global.title,type:e.type,value:JSON.stringify({global:d(e.global),value:d(e.value)})};(e.id?ae:ie)(l).then(r=>{g.value=!1,r.code==200&&(e.id?g.value=!1:k.push("/diy/list"))}).catch(r=>{g.value=!1})};return(l,t)=>{const r=Ce("ArrowLeft"),x=de,a=ue,R=Q,_=W,U=_e,F=fe,N=ve,h=ge,V=xe;return f(),w("div",Ie,[n(R,{class:"flex items-center h-[60px] bg-primary px-[20px]"},{default:s(()=>[i("div",{class:"text-white cursor-pointer flex items-center",onClick:L},[n(x,{size:"14"},{default:s(()=>[n(r)]),_:1}),i("span",De,u(o(p)("back")),1)]),i("div",Oe,[i("span",Be," ｜ "+u(o(p)("decorating"))+"："+u(o(e).typeName),1)]),Te,n(a,{onClick:t[0]||(t[0]=m=>P())},{default:s(()=>[T(u(o(p)("save")),1)]),_:1})]),_:1}),i("div",$e,[i("div",ze,[n(N,{class:"px-[10px]"},{default:s(()=>[n(F,{modelValue:I.value,"onUpdate:modelValue":t[1]||(t[1]=m=>I.value=m),onChange:j},{default:s(()=>[(f(!0),w($,null,z(S.value,(m,A)=>(f(),J(U,{key:A,title:m.type_name,name:m.type},{default:s(()=>[i("ul",Je,[(f(!0),w($,null,z(m.list,(C,H)=>(f(),w("li",{key:H,class:"w-2/6 text-center cursor-pointer h-[75px]",title:C.title,onClick:Ge=>o(e).addComponent(C)},[n(_,{name:C.icon,size:"23px"},null,8,["name"]),i("span",Le,u(C.title),1)],8,je))),128))])]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",Me,[n(N,null,{default:s(()=>[n(a,{class:"page-btn absolute right-[20px]",onClick:t[2]||(t[2]=m=>o(e).changeCurrentIndex(-99))},{default:s(()=>[T(u(o(p)("pageSet")),1)]),_:1}),i("div",Pe,[i("div",{class:"preview-head bg-no-repeat bg-center bg-cover",onClick:t[3]||(t[3]=m=>o(e).changeCurrentIndex(-99))},[i("span",Re,u(o(e).global.title),1)]),i("div",Ue,[i("ul",Fe,[n(h,{effect:"light",content:o(p)("moveUpComponent"),placement:"right"},{default:s(()=>[n(_,{name:"iconfont-iconjiantoushang",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).moveUpComponent},null,8,["onClick"])]),_:1},8,["content"]),n(h,{effect:"light",content:o(p)("moveDownComponent"),placement:"right"},{default:s(()=>[n(_,{name:"iconfont-iconjiantouxia",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).moveDownComponent},null,8,["onClick"])]),_:1},8,["content"]),n(h,{effect:"light",content:o(p)("copyComponent"),placement:"right"},{default:s(()=>[n(_,{name:"iconfont-iconcopy-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).copyComponent},null,8,["onClick"])]),_:1},8,["content"]),n(h,{effect:"light",content:o(p)("delComponent"),placement:"right"},{default:s(()=>[n(_,{name:"iconfont-icondelete-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).delComponent},null,8,["onClick"])]),_:1},8,["content"]),n(h,{effect:"light",content:o(p)("resetComponent"),placement:"right"},{default:s(()=>[n(_,{name:"iconfont-iconloader-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).resetComponent},null,8,["onClick"])]),_:1},8,["content"])]),we(i("iframe",{id:"previewIframe",src:E.value,frameborder:"0",class:"preview-iframe w-[375px]"},null,8,Ve),[[oe,E.value]])])])]),_:1})]),i("div",Ae,[n(N,null,{default:s(()=>[n(V,{class:"box-card",shadow:"never"},{header:s(()=>[i("div",He,[i("span",Qe,u(o(e).currentIndex==-99?o(p)("pageSet"):o(e).editComponent.componentTitle),1)])]),default:s(()=>[(f(),J(ke(O[o(e).currentComponent]),{value:o(e).value[o(e).currentIndex]},null,8,["value"]))]),_:1})]),_:1})])])])}}});const Bo=Ne(We,[["__scopeId","data-v-2e77ff98"]]);export{Bo as default};
