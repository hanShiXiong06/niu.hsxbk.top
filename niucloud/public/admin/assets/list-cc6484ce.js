import"./base-962c0c23.js";/* empty css                   *//* empty css                        */import{_ as Ee}from"./index-f4731ae1.js";import{E as we}from"./el-overlay-60700377.js";import{E as xe,b as Re}from"./el-radio-bfd4b1ad.js";/* empty css                    *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import"./index-7525671c.js";import"./el-tooltip-58212670.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css                *//* empty css                     *//* empty css                  */import{J as Ue,v as Te}from"./event-ff03ec12.js";import{t as a}from"./index-105fbad0.js";import{b as $e,c as Se,d as Fe,f as Ie,s as Le,h as Ne,j as Be,k as ze}from"./diy-e259258a.js";import{a as Ge,u as je}from"./vue-router-79053937.js";import{b as qe}from"./browser-a1ac24ac.js";import{u as Ae}from"./sys-4abedf95.js";import{a as pe}from"./index-d57cc47d.js";import{E as Ye}from"./index-50a00d09.js";import{E as Je}from"./index-bba9e58c.js";import{E as Me}from"./index-93f2c618.js";import{a as Oe,E as We}from"./index-61c777fa.js";import{a as He,E as Ke}from"./index-b933df38.js";import{E as Qe}from"./index-69523418.js";import{a as Xe,E as Ze}from"./index-92e1b5d5.js";import{E as et}from"./index-100b1469.js";import{a as tt,E as lt}from"./index-92c5bc98.js";import{E as at}from"./index-190f0dba.js";import{v as ot}from"./directive-c0c3e9a3.js";import{d as it,M as x,c as q,r as u,w as rt,b as m,e as C,q as o,p as i,f as v,x as s,u as e,v as d,m as y,F as N,t as A,C as D,L as Y}from"./runtime-core.esm-bundler-dc7a07d7.js";import"./index.vue_vue_type_style_index_0_lang-d0d31f1b.js";import"./attachment-56217309.js";/* empty css                 *//* empty css                    *//* empty css                   */import"./index-cc03da8f.js";import"./index-8bcaafa6.js";import"./focus-trap-b8b5a003.js";import"./storage-abe718b1.js";import"./index-7a123a20.js";import"./index-a9dd5cf5.js";import"./index-9f244af6.js";import"./index-df51d91a.js";import"./isEqual-c7d5e6d9.js";import"./_Uint8Array-6ff3cafa.js";import"./flatten-d5d1dc97.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-5d86eb33.js";import"./el-avatar-3bb47ce2.js";import"./common-080b9b9f.js";import"./common-2cf17469.js";import"./_initCloneObject-28e6bdaa.js";import"./index-4f5c40a5.js";import"./strings-4868a118.js";import"./_isIterateeCall-c579b126.js";const nt={class:"main-container"},st={class:"flex justify-between items-center"},pt={class:"text-[24px]"},mt={key:0},dt={key:0,class:"text-primary"},ut={key:1},ct={class:"mt-[16px] flex justify-end"},ft={class:"mr-[10px]"},_t={class:"mr-[10px]"},yt={class:"dialog-footer"},gt={class:"dialog-footer"},Tl=it({__name:"list",setup(vt){const $=x({}),J=Ge(),me=je().meta.title,f=x({title:"",template:"",template_name:""}),de=q(()=>({template:[{required:!0,message:a("pageTemplatePlaceholder"),trigger:"blur"}],title:[{required:!0,message:a("titlePlaceholder"),trigger:"blur"}]})),M=q(()=>{let r="";return f.template_name="",f.template&&(r=$[f.template].template),r}),O=u(),R=u(!1),ue=async r=>{r&&await r.validate(async t=>{t&&(R.value=!1,J.push(`/decorate/edit?template=${f.template}&template_name=${f.template_name}&title=${f.title}`))})};let g=x({loading:!0,data:[],searchParam:{title:"",type:""}});const S=u("");(async()=>{S.value=(await Ae()).data.wap_url})();const F=()=>{g.loading=!0,Se({...g.searchParam}).then(r=>{g.loading=!1,g.data=r.data}).catch(()=>{g.loading=!1})};F(),$e({}).then(r=>{for(let t in r.data)$[t]=r.data[t]});let p=x({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",template:""}});const k=u("diy"),ce=(r,t)=>{k.value=r.props.name,k.value=="diy"?V():F()},W=u(),H=u(),V=(r=1)=>{p.loading=!0,p.page=r,Fe({page:p.page,limit:p.limit,...p.searchParam}).then(t=>{p.loading=!1,p.data=t.data.data,p.total=t.data.total}).catch(()=>{p.loading=!1})};V();const fe=r=>{let t=J.resolve({path:"/decorate/edit",query:{id:r.id}});window.open(t.href)},_e=r=>{Ye.confirm(a("diyPageDeleteTips"),a("warning"),{confirmButtonText:a("confirm"),cancelButtonText:a("cancel"),type:"warning"}).then(()=>{Ie(r).then(()=>{V()}).catch(()=>{})})},ye=r=>{Le({id:r.id}).then(()=>{V()})},{copy:ge,isSupported:ve,copied:K}=Ue(),B=r=>{ve.value||pe({message:a("notSupportCopy"),type:"warning"}),ge(r)};rt(K,()=>{K.value&&pe({message:a("copySuccess"),type:"success"})});const b=u("wechat"),Q=u(""),X=u(0),E=x({title:"",name:"",page:"",is_share:0,sort:0}),h=x({wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}}),U=u(!1),be=q(()=>({})),Z=u(),ee=async r=>{if(k.value=="route"){let n=(await Ne({name:r.name})).data;n.title&&(r.id=n.id,r.title=n.title,r.name=n.name,r.page=n.page,r.is_share=n.is_share,r.sort=n.sort,r.share=n.share),E.title=r.title,E.name=r.name,E.page=r.page,E.is_share=r.is_share,E.sort=r.sort}X.value=r.id,Q.value=r.title;let t=r.share?JSON.parse(r.share):{wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}};t&&(h.wechat=t.wechat,h.weapp=t.weapp),U.value=!0},he=async r=>{r&&await r.validate(async t=>{t&&(k.value=="diy"?Be:ze)({id:X.value,share:JSON.stringify(h),...E}).then(()=>{k.value=="diy"?V():F(),U.value=!1}).catch(()=>{})})},z=u(!1);u("wechat");const I=u(""),te=u(""),ke=r=>{I.value=S.value+"/pages/index/diy?id="+r.id,qe.toDataURL(I.value,{errorCorrectionLevel:"L",margin:0,width:100}).then(t=>{te.value=t}),z.value=!0},le=r=>{r&&(r.resetFields(),V())};return(r,t)=>{const n=Je,w=Me,c=Oe,G=He,ae=Ke,T=We,oe=Qe,P=Xe,ie=Ze,Ve=et,L=tt,re=lt,ne=xe,Pe=Re,j=we,Ce=Ee,De=at,se=ot;return m(),C("div",nt,[o(oe,{class:"box-card !border-none",shadow:"never"},{default:i(()=>[v("div",st,[v("span",pt,s(e(me)),1),o(n,{type:"primary",class:"w-[100px]",onClick:t[0]||(t[0]=l=>R.value=!0)},{default:i(()=>[d(s(e(a)("addDiyPage")),1)]),_:1})]),o(oe,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:i(()=>[k.value=="diy"?(m(),y(T,{key:0,inline:!0,model:e(p).searchParam,ref_key:"searchFormDiyPageRef",ref:H},{default:i(()=>[o(c,{label:e(a)("title"),prop:"title"},{default:i(()=>[o(w,{modelValue:e(p).searchParam.title,"onUpdate:modelValue":t[1]||(t[1]=l=>e(p).searchParam.title=l),placeholder:e(a)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,{label:e(a)("typeName"),prop:"type"},{default:i(()=>[o(ae,{modelValue:e(p).searchParam.type,"onUpdate:modelValue":t[2]||(t[2]=l=>e(p).searchParam.type=l),placeholder:e(a)("pageTemplatePlaceholder")},{default:i(()=>[o(G,{label:e(a)("all"),value:""},null,8,["label"]),(m(!0),C(N,null,A($,(l,_)=>(m(),y(G,{label:l.title,value:_},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,null,{default:i(()=>[o(n,{type:"primary",onClick:t[3]||(t[3]=l=>V())},{default:i(()=>[d(s(e(a)("search")),1)]),_:1}),o(n,{onClick:t[4]||(t[4]=l=>le(H.value))},{default:i(()=>[d(s(e(a)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])):D("",!0),k.value=="route"?(m(),y(T,{key:1,inline:!0,model:e(g).searchParam,ref_key:"searchFormDiyRouteRef",ref:W},{default:i(()=>[o(c,{label:e(a)("title"),prop:"title"},{default:i(()=>[o(w,{modelValue:e(g).searchParam.title,"onUpdate:modelValue":t[5]||(t[5]=l=>e(g).searchParam.title=l),placeholder:e(a)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,null,{default:i(()=>[o(n,{type:"primary",onClick:t[6]||(t[6]=l=>F())},{default:i(()=>[d(s(e(a)("search")),1)]),_:1}),o(n,{onClick:t[7]||(t[7]=l=>le(W.value))},{default:i(()=>[d(s(e(a)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])):D("",!0)]),_:1}),v("div",null,[o(re,{modelValue:k.value,"onUpdate:modelValue":t[11]||(t[11]=l=>k.value=l),class:"demo-tabs",onTabClick:ce},{default:i(()=>[o(L,{label:e(a)("diyPage"),name:"diy"},{default:i(()=>[Y((m(),y(ie,{data:e(p).data,size:"large"},{empty:i(()=>[v("span",null,s(e(p).loading?"":e(a)("emptyData")),1)]),default:i(()=>[o(P,{prop:"title",label:e(a)("title"),"min-width":"120"},null,8,["label"]),o(P,{prop:"type_name",label:e(a)("typeName"),"min-width":"80"},null,8,["label"]),o(P,{label:e(a)("status"),"min-width":"80"},{default:i(({row:l})=>[l.type=="DIY_PAGE"?(m(),C("span",mt,"-")):(m(),C(N,{key:1},[l.is_default==1?(m(),C("span",dt,s(e(a)("isUse")),1)):(m(),C("span",ut,s(e(a)("unused")),1))],64))]),_:1},8,["label"]),o(P,{prop:"update_time",label:e(a)("updateTime"),"min-width":"120"},null,8,["label"]),o(P,{label:e(a)("operation"),fixed:"right",align:"right","min-width":"160"},{default:i(({row:l})=>[o(n,{type:"primary",link:"",onClick:_=>ke(l)},{default:i(()=>[d(s(e(a)("promote")),1)]),_:2},1032,["onClick"]),l.type!="DIY_PAGE"&&l.is_default==0?(m(),y(n,{key:0,type:"primary",link:"",onClick:_=>ye(l)},{default:i(()=>[d(s(e(a)("use")),1)]),_:2},1032,["onClick"])):D("",!0),l.type=="DIY_PAGE"?(m(),y(n,{key:1,type:"primary",link:"",onClick:_=>ee(l)},{default:i(()=>[d(s(e(a)("shareSet")),1)]),_:2},1032,["onClick"])):D("",!0),o(n,{type:"primary",link:"",onClick:_=>fe(l)},{default:i(()=>[d(s(e(a)("edit")),1)]),_:2},1032,["onClick"]),l.type=="DIY_PAGE"||l.is_default==0?(m(),y(n,{key:2,type:"danger",link:"",onClick:_=>_e(l.id)},{default:i(()=>[d(s(e(a)("delete")),1)]),_:2},1032,["onClick"])):D("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[se,e(p).loading]]),v("div",ct,[o(Ve,{"current-page":e(p).page,"onUpdate:currentPage":t[8]||(t[8]=l=>e(p).page=l),"page-size":e(p).limit,"onUpdate:pageSize":t[9]||(t[9]=l=>e(p).limit=l),layout:"total, sizes, prev, pager, next, jumper",total:e(p).total,onSizeChange:t[10]||(t[10]=l=>V()),onCurrentChange:V},null,8,["current-page","page-size","total"])])]),_:1},8,["label"]),o(L,{label:e(a)("basicRoute"),name:"route"},{default:i(()=>[Y((m(),y(ie,{data:e(g).data,size:"large"},{empty:i(()=>[v("span",null,s(e(g).loading?"":e(a)("emptyData")),1)]),default:i(()=>[o(P,{prop:"title",label:e(a)("title"),"min-width":"70"},null,8,["label"]),o(P,{prop:"page",label:e(a)("wapUrl"),"min-width":"170"},{default:i(({row:l})=>[v("span",ft,s(S.value+l.page),1),o(n,{type:"primary",link:"",onClick:_=>B(S.value+l.page)},{default:i(()=>[d(s(e(a)("copy")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"]),o(P,{prop:"page",label:e(a)("weappUrl"),"min-width":"120"},{default:i(({row:l})=>[v("span",_t,s(l.page),1),o(n,{type:"primary",link:"",onClick:_=>B(l.page)},{default:i(()=>[d(s(e(a)("copy")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"]),o(P,{label:e(a)("share"),fixed:"right","min-width":"80"},{default:i(({row:l})=>[l.is_share==1?(m(),y(n,{key:0,type:"primary",link:"",onClick:_=>ee(l)},{default:i(()=>[d(s(e(a)("shareSet")),1)]),_:2},1032,["onClick"])):D("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[se,e(g).loading]])]),_:1},8,["label"])]),_:1},8,["modelValue"])])]),_:1}),o(j,{modelValue:R.value,"onUpdate:modelValue":t[17]||(t[17]=l=>R.value=l),title:e(a)("addPageTips"),width:"25%"},{footer:i(()=>[v("span",yt,[o(n,{onClick:t[15]||(t[15]=l=>R.value=!1)},{default:i(()=>[d(s(e(a)("cancel")),1)]),_:1}),o(n,{type:"primary",onClick:t[16]||(t[16]=l=>ue(O.value))},{default:i(()=>[d(s(e(a)("confirm")),1)]),_:1})])]),default:i(()=>[o(T,{model:f,"label-width":"90px",ref_key:"formRef",ref:O,rules:e(de)},{default:i(()=>[o(c,{label:e(a)("title"),prop:"title"},{default:i(()=>[o(w,{modelValue:f.title,"onUpdate:modelValue":t[12]||(t[12]=l=>f.title=l),placeholder:e(a)("titlePlaceholder"),clearable:"",maxlength:"12","show-word-limit":"",class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,{label:e(a)("typeName"),prop:"template"},{default:i(()=>[o(ae,{modelValue:f.template,"onUpdate:modelValue":t[13]||(t[13]=l=>f.template=l),placeholder:e(a)("pageTemplatePlaceholder"),class:"w-full"},{default:i(()=>[(m(!0),C(N,null,A($,(l,_)=>(m(),y(G,{label:l.title,value:_},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),Y(o(c,{label:e(a)("templateName"),prop:"template_name"},{default:i(()=>[o(Pe,{modelValue:f.template_name,"onUpdate:modelValue":t[14]||(t[14]=l=>f.template_name=l)},{default:i(()=>[o(ne,{label:""},{default:i(()=>[d(s(e(a)("empty")),1)]),_:1}),(m(!0),C(N,null,A(e(M),(l,_)=>(m(),y(ne,{label:_},{default:i(()=>[d(s(l.title),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[Te,e(M)]])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(j,{modelValue:U.value,"onUpdate:modelValue":t[24]||(t[24]=l=>U.value=l),title:e(a)("shareSet"),width:"30%"},{footer:i(()=>[v("span",gt,[o(n,{onClick:t[22]||(t[22]=l=>U.value=!1)},{default:i(()=>[d(s(e(a)("cancel")),1)]),_:1}),o(n,{type:"primary",onClick:t[23]||(t[23]=l=>he(Z.value))},{default:i(()=>[d(s(e(a)("confirm")),1)]),_:1})])]),default:i(()=>[o(re,{modelValue:b.value,"onUpdate:modelValue":t[18]||(t[18]=l=>b.value=l)},{default:i(()=>[o(L,{label:e(a)("wechat"),name:"wechat"},null,8,["label"]),o(L,{label:e(a)("weapp"),name:"weapp"},null,8,["label"])]),_:1},8,["modelValue"]),o(T,{model:h[b.value],"label-width":"90px",ref_key:"shareFormRef",ref:Z,rules:e(be)},{default:i(()=>[o(c,{label:e(a)("sharePage")},{default:i(()=>[v("span",null,s(Q.value),1)]),_:1},8,["label"]),o(c,{label:e(a)("shareTitle"),prop:"title"},{default:i(()=>[o(w,{modelValue:h[b.value].title,"onUpdate:modelValue":t[19]||(t[19]=l=>h[b.value].title=l),placeholder:e(a)("shareTitlePlaceholder"),clearable:"",maxlength:"30","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),b.value=="wechat"?(m(),y(c,{key:0,label:e(a)("shareDesc"),prop:"desc"},{default:i(()=>[o(w,{modelValue:h[b.value].desc,"onUpdate:modelValue":t[20]||(t[20]=l=>h[b.value].desc=l),placeholder:e(a)("shareDescPlaceholder"),type:"textarea",rows:"4",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),o(c,{label:e(a)("shareImageUrl"),prop:"url"},{default:i(()=>[o(Ce,{modelValue:h[b.value].url,"onUpdate:modelValue":t[21]||(t[21]=l=>h[b.value].url=l),limit:1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(j,{modelValue:z.value,"onUpdate:modelValue":t[26]||(t[26]=l=>z.value=l),title:e(a)("promote"),width:"30%"},{default:i(()=>[o(T,{"label-width":"90px"},{default:i(()=>[o(c,{label:e(a)("shareLink")},{default:i(()=>[o(w,{readonly:"",value:I.value},{append:i(()=>[o(n,{onClick:t[25]||(t[25]=l=>B(I.value)),class:"bg-primary copy"},{default:i(()=>[d(s(e(a)("copy")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),o(c,{label:" "},{default:i(()=>[o(De,{src:te.value},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}});export{Tl as default};
