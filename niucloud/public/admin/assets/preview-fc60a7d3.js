/* empty css             */import{a as R,E as F}from"./el-form-item-144bc604.js";/* empty css                 *//* empty css                        *//* empty css                  *//* empty css                 */import{a3 as M,v as w}from"./event-3e082a4a.js";import{t as e}from"./index-ebefdd26.js";import{u as J}from"./vue-router-9f815af7.js";import{g as W}from"./weapp-5f218120.js";import{S as j}from"./index-d5447f06.js";import{c as z,a as A}from"./common-a45d855f.js";import{b as G}from"./browser-a1ac24ac.js";import{a as y}from"./index-a6ffcea0.js";import{E as H}from"./index-5f2625ed.js";import{E as K}from"./index-6f670765.js";import{E as Q}from"./index-6701860e.js";import{d as X,r as p,M as Y,w as Z,b as g,e as N,f as t,L as b,x as n,u as o,q as s,p as l,v as T,m as B,C as ee}from"./runtime-core.esm-bundler-c17ab5bc.js";import"./index-9ef6974e.js";import"./plugin-vue_export-helper-c018272e.js";import"./_baseClone-37ba2e68.js";import"./index-0d36ccbf.js";import"./el-main-03d12282.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-e42600b8.js";import"./el-overlay-380df695.js";import"./index-93efb1b5.js";import"./focus-trap-c0148071.js";import"./index-4b62c73a.js";import"./index-332680c2.js";/* empty css                  */import"./index-138bfa06.js";import"./index-72bf6cb5.js";import"./index-f6eed9e8.js";import"./debounce-196ce6a6.js";import"./position-0d02b322.js";const ae={class:"main-container w-[375px] mx-auto mt-[20px] mb-[40px] relative"},te={class:"flex h-full"},oe=["src"],se={class:"w-[375px] border border-slate-100 bg-body pt-[20px] px-[20px]"},le={class:"font-bold text-xl mb-[40px]"},re={class:"mb-[20px] flex flex-col"},pe={class:"mb-[10px]"},ie={key:0,class:"w-[400px] absolute bg-body top-[10%] -right-[450px]"},ne={class:"info-wrap mt-[20px]"},me={class:"px-[20px] pb-[10px] font-bold"},ce={class:"px-[20px] pb-[10px] font-bold mt-[40px]"},ue={class:"text-gray-400"},Qe=X({__name:"preview",setup(de){const u=p(""),d=p(""),_=p(""),i=p(""),c=p(!1),v=p(!1),E=p(0),D=p(0);new Date().getTime();const f=J();f.query.page=f.query.page||"",j().then(a=>{u.value=a.data.wap_url,C()});const O=()=>{if(d.value.trim().length==0){y({type:"warning",message:`${e("wapDomainPlaceholder")}`});return}u.value=d.value+"/wap",C(),A.set({key:"wap_domain",data:u.value}),c.value=!0,v.value=!1},C=()=>{f.query.page&&(i.value=`${u.value}${f.query.page}`,G.toDataURL(i.value,{errorCorrectionLevel:"L",margin:0,width:100}).then(a=>{_.value=a}),E.value=new Date().getTime(),setTimeout(()=>{D.value==0&&k()},1e3*2))};window.addEventListener("message",a=>{try{let m=JSON.parse(a.data);if(["appOnLaunch","appOnReady"].indexOf(m.type)!=-1){v.value=!1,c.value=!0;var r=new Date().getTime();D.value=r-E.value}}catch(m){k(),console.log("后台接受数据错误",m)}},!1);const k=()=>{v.value=!0,c.value=!1,i.value="",_.value=""},h=Y({qr_code:""});W().then(a=>{if(a.code==1){let r=a.data;h.qr_code=r.qr_code}});const{copy:U,isSupported:$,copied:q}=M(),P=a=>{$.value||y({message:e("notSupportCopy"),type:"warning"}),U(a)};return Z(q,()=>{q.value&&y({message:e("copySuccess"),type:"success"})}),(a,r)=>{const m=H,S=K,x=R,I=Q,L=F;return g(),N("div",ae,[t("div",te,[b(t("iframe",{class:"w-[375px]",src:i.value,frameborder:"0",id:"previewIframe"},null,8,oe),[[w,c.value]]),b(t("div",se,[t("div",le,n(o(e)("developTitle")),1),t("div",re,[t("text",pe,n(o(e)("wapDomain")),1),s(m,{modelValue:d.value,"onUpdate:modelValue":r[0]||(r[0]=V=>d.value=V),placeholder:o(e)("wapDomainPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),s(S,{type:"primary",onClick:O},{default:l(()=>[T(n(o(e)("confirm")),1)]),_:1})],512),[[w,v.value]]),c.value?(g(),N("div",ie,[t("div",ne,[t("div",me,n(o(e)("h5")),1),s(L,{"label-width":"40px",class:"px-[20px]"},{default:l(()=>[b(s(x,{label:o(e)("link")},{default:l(()=>[s(m,{readonly:"",value:i.value},{append:l(()=>[s(S,{onClick:r[1]||(r[1]=V=>P(i.value)),class:"bg-primary copy"},{default:l(()=>[T(n(o(e)("copy")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),[[w,i.value]]),b(s(x,{label:" "},{default:l(()=>[s(I,{src:_.value},null,8,["src"])]),_:1},512),[[w,_.value]])]),_:1}),t("div",ce,n(o(e)("weapp")),1),s(L,{"label-width":"40px",class:"px-[20px]"},{default:l(()=>[h.qr_code?(g(),B(x,{key:0,label:" "},{default:l(()=>[s(I,{class:"w-[100px] h-[100px]",src:o(z)(h.qr_code)},null,8,["src"])]),_:1})):(g(),B(x,{key:1,label:" "},{default:l(()=>[t("span",ue,n(o(e)("weappNotSet")),1)]),_:1}))]),_:1})])])):ee("",!0)])])}}});export{Qe as default};
