import{g as X,a4 as S,r as _,j as Y,m as p,n as E,F as n,E as l,q as f,L as u,u as i,K as d,a1 as N,D as c,I as C,J as D,T as b}from"./base-45eb5090.js";/* empty css                   */import{E as Z}from"./el-overlay-616d6124.js";/* empty css                     */import{E as ee,b as te}from"./el-radio-2719e44c.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{ar as ae,as as oe,at as le,ah as ne,au as ie,av as re,aw as me}from"./index-ad71a852.js";import"./el-tooltip-58212670.js";/* empty css                *//* empty css                      *//* empty css                        *//* empty css                    *//* empty css                  */import{t as o}from"./index-3694a2b2.js";import{u as se,a as pe}from"./vue-router-fcbaaf02.js";import{_ as ue}from"./cron-info.vue_vue_type_script_setup_true_lang-97da322a.js";import{E as de}from"./index-0d830c44.js";import{E as ce}from"./index-25c37860.js";import{a as _e,E as fe}from"./index-cbbcd330.js";import{E as ye}from"./index-e841b684.js";import{E as ge}from"./index-fc3020f4.js";import{a as ve,E as we}from"./index-cc9a73f0.js";import{a as ke,E as Ee}from"./index-2bfbe5a7.js";import{E as be}from"./index-4ce9333e.js";import{v as he}from"./directive-9f485fe5.js";import{_ as xe}from"./_plugin-vue_export-helper-c27b6911.js";import"./event-4977bef7.js";import"./index-cd1661d3.js";import"./focus-trap-318ae2e0.js";import"./storage-4159d1ed.js";import"./index-9670e877.js";import"./index-3be486d3.js";import"./el-avatar-bc58ad46.js";import"./index-aef37b98.js";import"./common-af78c857.js";import"./common-2cf17469.js";import"./_Uint8Array-e584e472.js";import"./_initCloneObject-983ff8c8.js";import"./index-c0090d79.js";import"./isEqual-f877b6c1.js";import"./flatten-0fc8b7eb.js";import"./_isIterateeCall-104f1f93.js";import"./index-201145a4.js";import"./strings-2444fdb3.js";const Ve={class:"main-container"},Te={class:"flex justify-between items-center"},Ce={class:"text-[20px]"},De={class:"mt-[10px]"},Ue={class:"mt-[16px] flex justify-end"},Be={class:"flex"},Le={class:"input-width flex items-center text-sm"},Re={class:"dialog-footer"},ze=X({__name:"schedule",setup(Fe){const $=se().meta.title,r=S({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",last_time:""}}),U=_([]),B=_([]),L=_([]);_(),(async()=>{U.value=await(await ae()).data,B.value=await(await oe()).data,L.value=await(await le()).data})();const g=(m=1)=>{r.loading=!0,r.page=m,ne({page:r.page,limit:r.limit,...r.searchParam}).then(a=>{r.loading=!1,r.data=a.data.data,r.total=a.data.total}).catch(()=>{r.loading=!1})};g(),pe();const w=_(!1),e=S({...{id:0,key:"",status:2,time:{type:"min",week:"",day:"",hour:"",min:""}}}),R=_(),j=()=>{e.id=0,e.key="",e.status=2,e.time.type="min",e.time.week="",e.time.day="",e.time.hour="",e.time.min="",w.value=!0},I=Y(()=>({key:[{required:!0,message:o("titlePlaceholder"),trigger:"blur"}],timeDate:[{required:!0,validator:O,trigger:"blur"}]})),O=(m,a,s)=>e.time.type=="min"&&e.time.min==""?s(new Error(o("cronTimeTips"))):e.time.type=="week"&&e.time.week==""&&e.time.hour==""&&e.time.min==""?s(new Error(o("cronTimeTips"))):e.time.type=="month"&&e.time.day==""&&e.time.hour==""&&e.time.min==""?s(new Error(o("cronTimeTips"))):e.time.type=="day"&&e.time.day==""&&e.time.hour==""&&e.time.min==""?s(new Error(o("cronTimeTips"))):e.time.type=="hour"&&e.time.hour==""&&e.time.min==""?s(new Error(o("cronTimeTips"))):s(),k=_(!1),q=async m=>{k.value||!m||await m.validate(async a=>{if(a){k.value=!0;const s=e;(e.id>0?ie:re)(s).then(z=>{k.value=!1,w.value=!1,g()}).catch(()=>{k.value=!1})}})},G=m=>{e.id=m.id,e.key=m.key,e.status=m.status,e.time=m.time,w.value=!0},J=m=>{de.confirm(o("cronDeleteTips"),o("warning"),{confirmButtonText:o("confirm"),cancelButtonText:o("cancel"),type:"warning"}).then(()=>{me(m).then(()=>{g()}).catch(()=>{})})},K=_(null);return(m,a)=>{const s=ce,v=_e,z=fe,M=ye,W=ge,h=ve,x=we,V=ke,T=be,F=ee,A=te,H=Ee,Q=Z,P=he;return p(),E("div",Ve,[n(W,{class:"box-card !border-none",shadow:"never"},{default:l(()=>[f("div",Te,[f("span",Ce,u(i($)),1),n(s,{type:"primary",onClick:j},{default:l(()=>[d(u(i(o)("addCron")),1)]),_:1})]),f("div",De,[N((p(),c(z,{data:r.data,size:"large"},{empty:l(()=>[f("span",null,u(r.loading?"":i(o)("emptyData")),1)]),default:l(()=>[n(v,{prop:"name",label:i(o)("title"),"min-width":"150"},null,8,["label"]),n(v,{prop:"key",label:i(o)("key"),"min-width":"150"},null,8,["label"]),n(v,{label:i(o)("crondType"),"min-width":"150"},{default:l(({row:t})=>[d(u(t.crontab_content),1)]),_:1},8,["label"]),n(v,{prop:"status_name",label:i(o)("openStatus"),"min-width":"100"},null,8,["label"]),n(v,{label:i(o)("operation"),fixed:"right",width:"130"},{default:l(({row:t})=>[n(s,{type:"primary",link:"",onClick:y=>G(t)},{default:l(()=>[d(u(i(o)("edit")),1)]),_:2},1032,["onClick"]),n(s,{type:"danger",link:"",onClick:y=>J(t.id)},{default:l(()=>[d(u(i(o)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[P,r.loading]]),f("div",Ue,[n(M,{"current-page":r.page,"onUpdate:currentPage":a[0]||(a[0]=t=>r.page=t),"page-size":r.limit,"onUpdate:pageSize":a[1]||(a[1]=t=>r.limit=t),layout:"total, sizes, prev, pager, next, jumper",total:r.total,onSizeChange:a[2]||(a[2]=t=>g()),onCurrentChange:g},null,8,["current-page","page-size","total"])])])]),_:1}),n(ue,{ref_key:"cronDialog",ref:K,onComplete:g},null,512),n(Q,{modelValue:w.value,"onUpdate:modelValue":a[11]||(a[11]=t=>w.value=t),title:i(o)("editCron"),width:"750px","destroy-on-close":!0},{footer:l(()=>[f("span",Re,[n(s,{type:"primary",onClick:a[10]||(a[10]=t=>q(R.value))},{default:l(()=>[d(u(i(o)("confirm")),1)]),_:1})])]),default:l(()=>[N((p(),c(H,{model:e,"label-width":"110px",ref_key:"formRef",ref:R,rules:i(I),class:"page-form"},{default:l(()=>[n(V,{label:i(o)("cronTemplate"),class:"items-center",prop:"key"},{default:l(()=>[n(x,{modelValue:e.key,"onUpdate:modelValue":a[3]||(a[3]=t=>e.key=t)},{default:l(()=>[(p(!0),E(C,null,D(U.value,t=>(p(),c(h,{key:t.key,label:t.name,value:t.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(V,{label:i(o)("cronTime"),prop:"timeDate"},{default:l(()=>[n(x,{modelValue:e.time.type,"onUpdate:modelValue":a[4]||(a[4]=t=>e.time.type=t),class:"w-[150px]"},{default:l(()=>[(p(!0),E(C,null,D(B.value,(t,y)=>(p(),c(h,{key:y,label:t,value:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),f("div",Be,[e.time.type=="week"?(p(),c(x,{key:0,modelValue:e.time.week,"onUpdate:modelValue":a[5]||(a[5]=t=>e.time.week=t),class:"ml-2 w-[120px]"},{default:l(()=>[(p(!0),E(C,null,D(L.value,(t,y)=>(p(),c(h,{key:y,label:t,value:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):b("",!0),["month","day"].indexOf(e.time.type)!=-1?(p(),c(T,{key:1,modelValue:e.time.day,"onUpdate:modelValue":a[6]||(a[6]=t=>e.time.day=t),class:"ml-2 w-[120px]"},{append:l(()=>[d(u(i(o)("day")),1)]),_:1},8,["modelValue"])):b("",!0),["month","day","hour","week"].indexOf(e.time.type)!=-1?(p(),c(T,{key:2,modelValue:e.time.hour,"onUpdate:modelValue":a[7]||(a[7]=t=>e.time.hour=t),class:"ml-2 w-[120px]"},{append:l(()=>[d(u(i(o)("hour")),1)]),_:1},8,["modelValue"])):b("",!0),["month","day","hour","week","min"].indexOf(e.time.type)!=-1?(p(),c(T,{key:3,modelValue:e.time.min,"onUpdate:modelValue":a[8]||(a[8]=t=>e.time.min=t),class:"ml-2 w-[120px]"},{append:l(()=>[d(u(i(o)("min")),1)]),_:1},8,["modelValue"])):b("",!0)])]),_:1},8,["label"]),n(V,{label:i(o)("openStatus")},{default:l(()=>[f("div",Le,[n(A,{modelValue:e.status,"onUpdate:modelValue":a[9]||(a[9]=t=>e.status=t)},{default:l(()=>[n(F,{label:1},{default:l(()=>[d(u(i(o)("yes")),1)]),_:1}),n(F,{label:2},{default:l(()=>[d(u(i(o)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[P,m.loading]])]),_:1},8,["modelValue","title"])])}}});const Lt=xe(ze,[["__scopeId","data-v-32720050"]]);export{Lt as default};
