/* empty css             *//* empty css                */import{a as K,E as Q}from"./el-form-item-144bc604.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{ac as W,aw as X,au as D,ax as Y,ay as Z}from"./index-d5447f06.js";/* empty css                  */import{_ as ee}from"./index-76a877c2.js";import{t as a}from"./index-ebefdd26.js";import{r as te,t as oe,u as ae}from"./delivery-a65fa4fc.js";import{u as le,a as re}from"./vue-router-9f815af7.js";import{E as se}from"./index-5f2625ed.js";import{a as ie,E as de}from"./index-b7b91fcb.js";import{E as ne}from"./index-6f670765.js";import{E as me}from"./index-c5af06c2.js";import{d as pe,r as F,M as I,c as ce,o as ue,b as c,e as v,f as m,x as _,u as r,q as s,p as n,F as k,t as P,m as M,v as L,w as _e,at as ge,au as fe}from"./runtime-core.esm-bundler-c17ab5bc.js";import{_ as ve}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-9ef6974e.js";import"./plugin-vue_export-helper-c018272e.js";import"./event-3e082a4a.js";import"./_baseClone-37ba2e68.js";import"./common-a45d855f.js";import"./index-0d36ccbf.js";import"./el-main-03d12282.js";import"./index-e42600b8.js";import"./el-overlay-380df695.js";import"./index-93efb1b5.js";import"./focus-trap-c0148071.js";import"./index-4b62c73a.js";import"./index-332680c2.js";import"./index-a6ffcea0.js";import"./index-138bfa06.js";import"./index-72bf6cb5.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-b9e244b2.js";import"./attachment-2dcaf405.js";/* empty css                   *//* empty css                      *//* empty css                    *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                    *//* empty css                   */import"./index-0ee6390f.js";import"./index-b74135ff.js";import"./aria-adfa05c5.js";import"./validator-f5e079db.js";import"./index-4ea26b0e.js";import"./index-d6b4c236.js";import"./index-6701860e.js";import"./index-f6eed9e8.js";import"./debounce-196ce6a6.js";import"./position-0d02b322.js";import"./index-d64b2f0e.js";import"./index-784d7581.js";import"./isEqual-ca98cf0c.js";import"./index-cefc0b67.js";import"./directive-d226d53f.js";import"./index-5c20ff8f.js";import"./strings-e72e60f7.js";import"./index-bfecf17f.js";const C=y=>(ge("data-v-2ab69b49"),y=y(),fe(),y),be={class:"main-container"},he={class:"detail-head"},ye=C(()=>m("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1)),we={class:"ml-[1px]"},Ve=C(()=>m("span",{class:"adorn"},"|",-1)),xe={key:0,class:"right"},ke={key:1,class:"right"},Pe={class:"text-[12px] text-[#999]"},Me=C(()=>m("div",{class:"mt-4"},[m("div",{id:"TxMap",class:"map-item w-[800px] h-[500px]"})],-1)),Le={class:"fixed-footer-wrap"},Ce={class:"fixed-footer"},Ee=pe({__name:"store_edit",setup(y){const E=le(),T=re(),w=parseInt(E.query.id),V=F(!1);E.meta.title;const q={store_id:0,store_name:"",store_desc:"",store_logo:"",store_mobile:"",province_id:0,province_name:"",city_id:0,city_name:"",district_id:0,district_name:"",address:"",full_address:"",longitude:"",latitude:"",trade_time:""},e=I({...q});w&&(async(o=0)=>{Object.assign(e,q);const t=await(await te(o)).data;Object.keys(e).forEach(i=>{t[i]!=null&&(e[i]=t[i])})})(w);const S=F(),U=ce(()=>({store_name:[{required:!0,message:a("storeNamePlaceholder"),trigger:"blur"}],store_logo:[{required:!0,message:a("storeLogoPlaceholder"),trigger:"blur"}],store_mobile:[{required:!0,message:a("storeMobilePlaceholder"),trigger:"blur"}],province_id:[{required:!0,message:a("provinceIdPlaceholder"),trigger:"blur"}],city_id:[{required:!0,message:a("cityIdPlaceholder"),trigger:"blur"}],district_id:[{required:!0,message:a("districtIdPlaceholder"),trigger:"blur"}],address_area:[{required:!0,validator:j,trigger:"blur"}],address:[{required:!0,message:a("storeAddressDetailPlaceholder"),trigger:"blur"}],trade_time:[{required:!0,message:a("tradeTimePlaceholder"),trigger:"blur"}]})),j=(o,t,i)=>{(e.province_name==""||e.city_name==""||e.district_name=="")&&i(new Error(a("storeAddressPlaceholder"))),i()},B=async o=>{V.value||!o||await o.validate(async t=>{t&&(V.value=!0,(w?oe:ae)(e).then(u=>{V.value=!1,T.push("/shop/order/delivery/store")}).catch(u=>{V.value=!1}))})},g=I({province:[],city:[],district:[]});(()=>{X(1).then(o=>{g.province=o.data})})();const N=o=>{Object.keys(o).length==0?o.id=e.province_id:(e.province_id=o.id,e.province_name=o.name),D(o.id).then(t=>{g.city=t.data})},O=o=>{Object.keys(o).length==0?o.id=e.city_id:(e.city_id=o.id,e.city_name=o.name),D(o.id).then(t=>{g.district=t.data})},R=o=>{e.district_id=o.id,e.district_name=o.name},z=()=>{e.province_id&&e.city_id&&e.district_id&&e.address&&(e.full_address=e.province_name+e.city_name+e.district_name+e.address,Y({address:e.full_address}).then(o=>{e.latitude=o.data.result.location.lat,e.longitude=o.data.result.location.lng}))};let b;const G=()=>{let o=e.latitude,t=e.longitude;e.latitude==0&&(o="39.90469"),e.longitude==0&&(t="116.40717");const i=new window.TMap.LatLng(o,t);b=new window.TMap.Map("TxMap",{center:i,zoom:17,viewMode:"2D",showControl:!0}),b.on("click",u=>{const p={lat:u.latLng.getLat().toFixed(6),lng:u.latLng.getLng().toFixed(6)};$(p.lat,p.lng,1),d.updateGeometries({id:"shop",position:u.latLng})});const d=new window.TMap.MultiMarker({id:"marker-layer",map:b,minimumClusterSize:1});d.updateGeometries({id:"shop",position:i}),b.on("idle",()=>{_e(()=>e.latitude,(u,p)=>{const f=new window.TMap.LatLng(e.latitude,e.longitude);b.panTo(f,1),d.updateGeometries({id:"shop",position:f})})})};ue(()=>{const o=document.createElement("script");W().then(t=>{o.type="text/javascript",o.src="https://map.qq.com/api/gljs?v=1.exp&key="+t.data.key,document.body.appendChild(o)}),o.onload=()=>{setTimeout(()=>{G()},500)}});const $=(o,t,i)=>{Z({location:o+","+t}).then(d=>{e.province_name=d.data.result.address_component.province,e.city_name=d.data.result.address_component.city,e.district_name=d.data.result.address_component.district,i==1&&(e.address=d.data.result.formatted_addresses.recommend,e.full_address=e.province_name+e.city_name+e.district_name+e.address,e.latitude=o,e.longitude=t)})},A=()=>{T.push("/shop/order/delivery/store")};return(o,t)=>{const i=se,d=K,u=ee,p=ie,f=de,x=ne,H=Q,J=me;return c(),v("div",be,[m("div",he,[m("div",{class:"left",onClick:t[0]||(t[0]=l=>A())},[ye,m("span",we,_(r(a)("returnToPreviousPage")),1)]),Ve,r(w)?(c(),v("span",xe,_(r(a)("updateStore")),1)):(c(),v("span",ke,_(r(a)("addStore")),1))]),s(J,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[s(H,{model:e,"label-width":"140px",ref_key:"formRef",ref:S,rules:r(U),class:"page-form"},{default:n(()=>[s(d,{label:r(a)("storeName"),prop:"store_name"},{default:n(()=>[s(i,{modelValue:e.store_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.store_name=l),clearable:"",placeholder:r(a)("storeNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(d,{label:r(a)("storeDesc")},{default:n(()=>[s(i,{modelValue:e.store_desc,"onUpdate:modelValue":t[2]||(t[2]=l=>e.store_desc=l),type:"textarea",rows:"4",clearable:"",placeholder:r(a)("storeDescPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(d,{label:r(a)("storeLogo")},{default:n(()=>[s(u,{modelValue:e.store_logo,"onUpdate:modelValue":t[3]||(t[3]=l=>e.store_logo=l)},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(a)("storeMobile"),prop:"store_mobile"},{default:n(()=>[s(i,{modelValue:e.store_mobile,"onUpdate:modelValue":t[4]||(t[4]=l=>e.store_mobile=l),clearable:"",placeholder:r(a)("storeMobilePlaceholder"),class:"input-width",onkeyup:"this.value = this.value.replace(/[^\\d\\.]/g,'');"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(d,{label:r(a)("tradeTime"),prop:"trade_time"},{default:n(()=>[m("div",null,[s(i,{modelValue:e.trade_time,"onUpdate:modelValue":t[5]||(t[5]=l=>e.trade_time=l),clearable:"",placeholder:r(a)("tradeTimePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),m("p",Pe,_(r(a)("tradeTimeTips")),1)])]),_:1},8,["label"]),s(d,{label:r(a)("storeAddress"),prop:"address_area"},{default:n(()=>[s(f,{modelValue:e.province_name,"onUpdate:modelValue":t[6]||(t[6]=l=>e.province_name=l),"value-key":"id",clearable:"",class:"w-[200px]",onChange:N},{default:n(()=>[s(p,{label:r(a)("provincePlaceholder"),value:""},null,8,["label"]),(c(!0),v(k,null,P(g.province,(l,h)=>(c(),M(p,{key:h,label:l.name,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(f,{modelValue:e.city_name,"onUpdate:modelValue":t[7]||(t[7]=l=>e.city_name=l),"value-key":"id",clearable:"",class:"w-[200px] ml-3",onChange:O},{default:n(()=>[s(p,{label:r(a)("cityPlaceholder"),value:""},null,8,["label"]),(c(!0),v(k,null,P(g.city,(l,h)=>(c(),M(p,{key:h,label:l.name,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(f,{modelValue:e.district_name,"onUpdate:modelValue":t[8]||(t[8]=l=>e.district_name=l),"value-key":"id",clearable:"",class:"w-[200px] ml-3",onChange:R},{default:n(()=>[s(p,{label:r(a)("districtPlaceholder"),value:""},null,8,["label"]),(c(!0),v(k,null,P(g.district,(l,h)=>(c(),M(p,{key:h,label:l.name,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(a)("storeAddressDetail"),prop:"address"},{default:n(()=>[m("div",null,[m("div",null,[s(i,{modelValue:e.address,"onUpdate:modelValue":t[9]||(t[9]=l=>e.address=l),clearable:"",placeholder:r(a)("storeAddressDetailPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),s(x,{class:"ml-3",onClick:z},{default:n(()=>[L(_(r(a)("search")),1)]),_:1})]),Me])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1}),m("div",Le,[m("div",Ce,[s(x,{type:"primary",onClick:t[10]||(t[10]=l=>B(S.value))},{default:n(()=>[L(_(r(a)("save")),1)]),_:1}),s(x,{onClick:t[11]||(t[11]=l=>A())},{default:n(()=>[L(_(r(a)("cancel")),1)]),_:1})])])])}}});const Gt=ve(Ee,[["__scopeId","data-v-2ab69b49"]]);export{Gt as default};
