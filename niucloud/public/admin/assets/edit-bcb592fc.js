/* empty css             *//* empty css                   *//* empty css                  *//* empty css                */import{a as z,E as M}from"./el-form-item-144bc604.js";/* empty css                       *//* empty css                 */import"./index-1bbcede8.js";/* empty css                  *//* empty css                          *//* empty css               *//* empty css                    *//* empty css                 *//* empty css                       */import{v as c}from"./event-3e082a4a.js";import{t as i}from"./index-3862e13d.js";import{u as A,a as H}from"./vue-router-9f815af7.js";import{c as J,g as K,e as Q}from"./marketing-c66388c2.js";import W from"./goods-select-popup-c720cd43.js";import{E as X}from"./index-5f2625ed.js";import{E as Y,b as Z}from"./index-6ff31475.js";import{E as ee}from"./index-22ce9a15.js";import{E as le}from"./index-70d29087.js";import{E as te}from"./index-c5af06c2.js";import{E as oe}from"./index-6f670765.js";import{v as ae}from"./directive-d226d53f.js";import{d as ie,r as y,c as re,o as ue,L as v,b as E,e as ne,f as m,u as r,x as s,m as de,p as o,q as l,v as u,C as me}from"./runtime-core.esm-bundler-c17ab5bc.js";import"./index-9ef6974e.js";import"./plugin-vue_export-helper-c018272e.js";import"./_baseClone-37ba2e68.js";import"./common-a45d855f.js";import"./index-0d36ccbf.js";import"./el-main-03d12282.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-e42600b8.js";import"./el-overlay-380df695.js";import"./index-93efb1b5.js";import"./focus-trap-c0148071.js";import"./index-4b62c73a.js";import"./index-332680c2.js";import"./index-a6ffcea0.js";import"./index-138bfa06.js";import"./index-72bf6cb5.js";/* empty css                      *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        */import"./goods_default-3802d665.js";import"./goods-fd566118.js";import"./cloneDeep-028669bf.js";import"./index-b7b91fcb.js";import"./index-5c20ff8f.js";import"./strings-e72e60f7.js";import"./isEqual-ca98cf0c.js";import"./debounce-196ce6a6.js";import"./index-bfecf17f.js";import"./validator-f5e079db.js";import"./index-6191b0b4.js";import"./index-784d7581.js";import"./_isIterateeCall-797defa1.js";import"./index-6701860e.js";import"./index-f6eed9e8.js";import"./position-0d02b322.js";import"./index-cefc0b67.js";import"./rand-14326ce1.js";import"./aria-adfa05c5.js";import"./arrays-e667dc24.js";import"./index-43e913f7.js";const pe={class:"main-container"},se={class:"detail-head"},ve=m("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1),_e={class:"ml-[1px]"},ce=m("span",{class:"adorn"},"|",-1),fe={class:"right"},ye={class:"flex items-center",style:{"padding-left":"5px"}},ge={class:"flex items-center",style:{"padding-left":"5px"}},be={class:"w-[220px]",style:{"padding-left":"5px"}},Ve=m("div",{class:"form-tip"},"开启手动领取后，会员可以直接在优惠券列表以及优惠券推广中直接领取",-1),he={class:"w-[180px]"},xe={class:"fixed-footer-wrap"},Ce={class:"fixed-footer"},zl=ie({__name:"edit",setup(we){const k=A(),U=H(),P=parseInt(k.query.id),f=y(!1),R=new Date,T=y(null),b=new Date;b.setTime(b.getTime()+3600*1e3*2*360);const e=y({...{title:"",price:"",type:1,limit:2,receive_type:2,remain_count:1e3,threshold:2,limit_count:"",min_condition_money:"",length:30,goods_ids:[],goods_category_ids:[],receive_type_time:2,valid_type:1,receive_time:[R,b],valid_time:b}}),V=y(),D=re(()=>({title:[{required:!0,message:i("titlePlaceholder"),trigger:"blur"}],price:[{required:!0,validator:L,trigger:"blur"}],remain_count:[{required:!0,validator:S,trigger:"blur"}],limit_count:[{required:!0,validator:q,trigger:"blur"}]})),S=(_,t,d)=>{e.value.remain_count!=""&&e.value.remain_count>1e5&&d(new Error(i("remainCountPlaceholder"))),d()},L=(_,t,d)=>{e.value.price!=""&&e.value.price<.01&&d(new Error(i("pricePlaceholder"))),d()},q=(_,t,d)=>{e.value.limit_count!=""&&e.value.limit_count<1&&d(new Error(i("userLimitCountPlaceholder"))),d()};y(!0),y(1);const I={multiple:!0};y([]);const h=y([]),x=()=>{K({}).then(_=>{h.value=_.data.goods_category_tree})};x();const B=async _=>{f.value||!_||await _.validate(async t=>{if(t){f.value=!0;let d=e.value;Q(d).then(p=>{f.value=!1,history.back()}).catch(p=>{f.value=!1})}})};ue(async()=>{F(P)});const F=_=>{f.value=!0,J(_).then(t=>{e.value=Object.assign(e.value,t.data),f.value=!1}).catch(()=>{f.value=!1})},N=()=>{history.back()};return(_,t)=>{const d=X,n=z,p=Y,g=Z,j=ee,C=le,$=M,G=te,w=oe,O=ae;return v((E(),ne("div",pe,[m("div",se,[m("div",{class:"left",onClick:t[0]||(t[0]=a=>r(U).push("/shop/marketing/coupon/list"))},[ve,m("span",_e,s(r(i)("returnToPreviousPage")),1)]),ce,m("span",fe,s(r(i)("editCoupon")),1)]),Object.keys(e.value).length?(E(),de(G,{key:0,class:"box-card !border-none page-height",shadow:"never"},{default:o(()=>[l($,{model:e.value,"label-width":"120px",ref_key:"formRef",ref:V,rules:r(D),class:"page-form"},{default:o(()=>[l(n,{label:r(i)("title"),prop:"title"},{default:o(()=>[l(d,{modelValue:e.value.title,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value.title=a),clearable:"",placeholder:r(i)("titlePlaceholder"),class:"input-width",maxlength:20},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(n,{label:r(i)("price"),prop:"price"},{default:o(()=>[l(d,{type:"number",οninput:"value=value.replace(/[^\\d.]/g,'')",modelValue:e.value.price,"onUpdate:modelValue":t[2]||(t[2]=a=>e.value.price=a),clearable:"",placeholder:r(i)("pricePlaceholder"),class:"input-width",maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(n,{label:r(i)("type"),prop:"type"},{default:o(()=>[l(g,{modelValue:e.value.type,"onUpdate:modelValue":t[3]||(t[3]=a=>e.value.type=a)},{default:o(()=>[l(p,{label:1},{default:o(()=>[u("通用券")]),_:1}),l(p,{label:2,onClick:x},{default:o(()=>[u("品类券")]),_:1}),l(p,{label:3},{default:o(()=>[u("商品券")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),v(l(n,null,{default:o(()=>[m("div",null,[l(j,{modelValue:e.value.goods_category_ids,"onUpdate:modelValue":t[4]||(t[4]=a=>e.value.goods_category_ids=a),options:h.value,props:I,"collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["modelValue","options"])])]),_:1},512),[[c,e.value.type==2]]),v(l(n,null,{default:o(()=>[m("div",null,[l(n,null,{default:o(()=>[l(W,{ref_key:"goodsSelectPopupRef",ref:T,modelValue:e.value.goods_ids,"onUpdate:modelValue":t[5]||(t[5]=a=>e.value.goods_ids=a),min:"1",max:"99"},null,8,["modelValue"])]),_:1})])]),_:1},512),[[c,e.value.type==3]]),l(n,{label:r(i)("threshold")},{default:o(()=>[l(g,{modelValue:e.value.threshold,"onUpdate:modelValue":t[6]||(t[6]=a=>e.value.threshold=a)},{default:o(()=>[l(p,{label:1},{default:o(()=>[u(s(r(i)("reduction")),1)]),_:1}),l(p,{label:2},{default:o(()=>[u(s(r(i)("noThreshold")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),v(l(n,null,{default:o(()=>[u(" 最低满 "),m("div",ye,[l(d,{type:"number",οninput:"value=value.replace(/[^\\d.]/g,'')",modelValue:e.value.min_condition_money,"onUpdate:modelValue":t[7]||(t[7]=a=>e.value.min_condition_money=a),clearable:"",class:"!w-[100px]"},null,8,["modelValue"])]),u(" 元可用 ")]),_:1},512),[[c,e.value.threshold==1]]),l(n,{label:r(i)("validType")},{default:o(()=>[l(g,{modelValue:e.value.valid_type,"onUpdate:modelValue":t[8]||(t[8]=a=>e.value.valid_type=a)},{default:o(()=>[l(p,{label:1},{default:o(()=>[u(s(r(i)("days")),1)]),_:1}),l(p,{label:2},{default:o(()=>[u(s(r(i)("times")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),v(l(n,null,{default:o(()=>[u(" 领劵后立即生效，有效期 "),m("div",ge,[l(d,{type:"number",modelValue:e.value.length,"onUpdate:modelValue":t[9]||(t[9]=a=>e.value.length=a),clearable:"",class:"!w-[100px]"},null,8,["modelValue"]),u(" 天 ")])]),_:1},512),[[c,e.value.valid_type==1]]),v(l(n,{prop:"valid_time"},{default:o(()=>[u(" 领劵后立即生效，使用时间截止至 "),m("div",be,[l(C,{modelValue:e.value.valid_time,"onUpdate:modelValue":t[10]||(t[10]=a=>e.value.valid_time=a),type:"datetime",placeholder:r(i)("validTimePlaceholder")},null,8,["modelValue","placeholder"])])]),_:1},512),[[c,e.value.valid_type==2]]),l(n,{label:r(i)("receiveType")},{default:o(()=>[m("div",null,[l(g,{modelValue:e.value.receive_type,"onUpdate:modelValue":t[11]||(t[11]=a=>e.value.receive_type=a)},{default:o(()=>[l(p,{label:1},{default:o(()=>[u(s(r(i)("user")),1)]),_:1}),l(p,{label:2},{default:o(()=>[u(s(r(i)("grant")),1)]),_:1})]),_:1},8,["modelValue"])]),Ve]),_:1},8,["label"]),v(l(n,{label:r(i)("receiveTime")},{default:o(()=>[l(g,{modelValue:e.value.receive_type_time,"onUpdate:modelValue":t[12]||(t[12]=a=>e.value.receive_type_time=a)},{default:o(()=>[l(p,{label:1},{default:o(()=>[u(s(r(i)("limitedTime")),1)]),_:1}),l(p,{label:2},{default:o(()=>[u(s(r(i)("unlimitedTime")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.value.receive_type==1]]),v(l(n,{prop:"receive_time"},{default:o(()=>[m("div",he,[l(C,{modelValue:e.value.receive_time,"onUpdate:modelValue":t[13]||(t[13]=a=>e.value.receive_time=a),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])]),_:1},512),[[c,e.value.receive_type_time==1&&e.value.receive_type==1]]),v(l(n,{label:r(i)("receiveNumber")},{default:o(()=>[l(g,{modelValue:e.value.limit,"onUpdate:modelValue":t[14]||(t[14]=a=>e.value.limit=a)},{default:o(()=>[l(p,{label:1},{default:o(()=>[u(s(r(i)("limit")),1)]),_:1}),l(p,{label:2},{default:o(()=>[u(s(r(i)("unlimited")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.value.receive_type==1]]),v(l(n,{prop:"remain_count"},{default:o(()=>[m("div",null,[l(d,{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.remain_count,"onUpdate:modelValue":t[15]||(t[15]=a=>e.value.remain_count=a),clearable:"",placeholder:r(i)("remainCountPlaceholder"),class:"input-width",min:e.value.remain_count,max:1e5,controls:!1},{append:o(()=>[u("张")]),_:1},8,["modelValue","placeholder","min"])])]),_:1},512),[[c,e.value.limit==1&&e.value.receive_type==1]]),v(l(n,{label:r(i)("userLimitCount"),prop:"limit_count"},{default:o(()=>[l(d,{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.limit_count,"onUpdate:modelValue":t[16]||(t[16]=a=>e.value.limit_count=a),clearable:"",placeholder:r(i)("userLimitCountPlaceholder"),class:"input-width",min:1,max:1e5},{append:o(()=>[u("张")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.value.receive_type==1]])]),_:1},8,["model","rules"])]),_:1})):me("",!0),m("div",xe,[m("div",Ce,[l(w,{type:"primary",onClick:t[17]||(t[17]=a=>B(V.value))},{default:o(()=>[u(s(r(i)("save")),1)]),_:1}),l(w,{onClick:t[18]||(t[18]=a=>N())},{default:o(()=>[u(s(r(i)("cancel")),1)]),_:1})])])])),[[O,f.value]])}}});export{zl as default};
