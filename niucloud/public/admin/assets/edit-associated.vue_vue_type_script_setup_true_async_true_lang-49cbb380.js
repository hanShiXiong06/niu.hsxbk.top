/* empty css             */import{E as S}from"./el-overlay-380df695.js";/* empty css                  */import{a as I,E as O}from"./el-form-item-144bc604.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import"./index-d5447f06.js";/* empty css                  */import{t as a}from"./index-ebefdd26.js";import{g as j,l as z,m as H}from"./tools-928f7497.js";import{c as F}from"./cloneDeep-028669bf.js";import{a as J,E as Q}from"./index-b7b91fcb.js";import{E as W}from"./index-5f2625ed.js";import{E as X}from"./index-6f670765.js";import{d as Y,r as s,c as Z,b as u,m as f,p as d,f as ee,q as t,v as C,x as q,u as r,e as _,F as b,t as h,ac as le}from"./runtime-core.esm-bundler-c17ab5bc.js";const ae={class:"dialog-footer"},ke=Y({__name:"edit-associated",props:{table_name:{type:String,required:!0}},emits:["complete"],setup(x,{expose:K,emit:U}){const M=x,m=s(!1);s(!1);const N=s(""),V={type:"has_one",name:"",addon:"system",model:"",local_key:"",foreign_key:""},o=s({...V}),g=s(),T=Z(()=>({type:[{required:!0,message:a("associatedTypePlaceholder"),trigger:"change"}],name:[{required:!0,message:a("associatedNamePlaceholder"),trigger:"blur"}],addon:[{required:!0,message:a("addonsPlaceholder"),trigger:"change"}],model:[{required:!0,message:a("associatedModelPlaceholder"),trigger:"change"}],local_key:[{required:!0,message:a("localKeyPlaceholder"),trigger:"change"}],foreign_key:[{required:!0,message:a("foreignKeyPlaceholder"),trigger:"blur"}]})),k=s([]),w=n=>{z(n).then(e=>{k.value=e.data})},E=s([]),A=n=>{H({table_name:n}).then(e=>{E.value=e.data})},v=s([]);(async()=>{let{data:n}=await j({});v.value=[{title:"系统",key:"system"}],v.value.push(...n),w({addon:"system"})})();const B=n=>{o.value.model="",w({addon:n})},G=n=>{var e;(e=g.value)==null||e.clearValidate(),n()},L=async n=>{n&&await n.validate(async e=>{e&&(U("complete",le(o.value)),m.value=!1)})};return K({showDialog:m,setFormData:async(n=null)=>{A(M.table_name),n?o.value=F(n):o.value=F(V),m.value=!0}}),(n,e)=>{const i=J,c=Q,p=I,P=W,R=O,D=X,$=S;return u(),f($,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=l=>m.value=l),title:N.value,width:"500px","before-close":G,"destroy-on-close":!0},{footer:d(()=>[ee("span",ae,[t(D,{onClick:e[6]||(e[6]=l=>m.value=!1)},{default:d(()=>[C(q(r(a)("cancel")),1)]),_:1}),t(D,{type:"primary",onClick:e[7]||(e[7]=l=>L(g.value))},{default:d(()=>[C(q(r(a)("confirm")),1)]),_:1})])]),default:d(()=>[t(R,{model:o.value,"label-width":"120px",ref_key:"formRef",ref:g,rules:r(T),class:"page-form"},{default:d(()=>[t(p,{label:r(a)("associatedType"),prop:"type"},{default:d(()=>[t(c,{placeholder:r(a)("associatedTypePlaceholder"),modelValue:o.value.type,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.type=l),class:"input-width"},{default:d(()=>[t(i,{label:r(a)("hasOne"),value:"has_one"},null,8,["label"]),t(i,{label:r(a)("hasMany"),value:"has_many"},null,8,["label"])]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),t(p,{label:r(a)("associatedName"),prop:"name"},{default:d(()=>[t(P,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.name=l),placeholder:r(a)("associatedNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(p,{label:r(a)("addons"),prop:"addon"},{default:d(()=>[t(c,{modelValue:o.value.addon,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.addon=l),placeholder:r(a)("addonsPlaceholder"),class:"input-width",onChange:B},{default:d(()=>[(u(!0),_(b,null,h(v.value,(l,y)=>(u(),f(i,{label:l.title,value:l.key,key:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(p,{label:r(a)("associatedModel"),prop:"model"},{default:d(()=>[t(c,{placeholder:r(a)("associatedModelPlaceholder"),modelValue:o.value.model,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.model=l),class:"input-width"},{default:d(()=>[(u(!0),_(b,null,h(k.value,l=>(u(),f(i,{label:l,value:l,key:l},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),t(p,{prop:"local_key",label:r(a)("localKey")},{default:d(()=>[t(c,{class:"input-width",placeholder:r(a)("localKeyPlaceholder"),modelValue:o.value.local_key,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.local_key=l)},{default:d(()=>[(u(!0),_(b,null,h(E.value,(l,y)=>(u(),f(i,{label:`${l.name}:${l.comment}`,value:l.name,key:y},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),t(p,{label:r(a)("foreignKey"),prop:"foreign_key"},{default:d(()=>[t(P,{modelValue:o.value.foreign_key,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.foreign_key=l),placeholder:r(a)("foreignKeyPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{ke as _};
