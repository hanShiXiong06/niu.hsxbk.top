import"./base-0e92f4db.js";/* empty css                   */import{E as H}from"./el-overlay-3eff2fc5.js";/* empty css                  */import{a as J,E as Q}from"./el-form-item-c2dd2ffe.js";/* empty css                        *//* empty css                 */import{_ as W}from"./index-64a4f07e.js";/* empty css               *//* empty css                  *//* empty css                  */import{A as X,B as Y,C as ee,D as le,F as ae}from"./index-95d7b9b8.js";/* empty css                  *//* empty css                *//* empty css                    *//* empty css                       *//* empty css                 */import{v}from"./event-a537c4cb.js";import{t}from"./index-bf9b1162.js";import{g as te}from"./tools-140c7006.js";import{E as oe}from"./index-8cefa3ab.js";import{E as ne,b as ue}from"./index-9aa10ae4.js";import{a as re,E as de}from"./index-757074f4.js";import{E as me}from"./index-5ba48958.js";import{E as se}from"./index-62f985cf.js";import{E as pe}from"./index-e09a20f5.js";import{v as ie}from"./directive-c6f70b8e.js";import{d as _e,r as f,M as fe,c as ce,b as c,m as b,p as n,f as x,q as a,v as p,x as i,u,L as y,C as ye,e as ve,F as be,t as Ve}from"./runtime-core.esm-bundler-67034826.js";const he={class:"input-width"},ge={class:"dialog-footer"},Xe=_e({__name:"edit-menu",props:{menuTree:{type:Array,default:()=>[]}},emits:["complete"],setup(we,{expose:C,emit:I}){const V=f(!1),w=f("post"),_=f(!1);let k="";const M={id:0,menu_name:"",menu_type:0,parent_key:"",icon:"",api_url:"",router_path:"",view_path:"",methods:"",sort:"",status:1,is_show:1,menu_key:"",app_type:"",addon:"",menu_short_name:""},e=fe({...M}),E=f([]),P=f([]),U=f([]),D=f(),A=r=>/^([a-zA-Z_$])([a-zA-Z0-9_$])*$/.test(r),q=ce(()=>({menu_name:[{required:!0,message:t("menuNamePlaceholder"),trigger:"blur"}],menu_key:[{required:!0,message:t("menuKeyPlaceholder"),trigger:"blur"},{validator:(r,l,d)=>{A(l)||d(new Error(t("menuKeyValidata"))),d()},trigger:"blur"}],router_path:[{required:e.menu_type!=2,message:t("routePathPlaceholder"),trigger:"blur"}],view_path:[{required:e.menu_type==1,message:t("viewPathPlaceholder"),trigger:"blur"}],icon:[{required:e.menu_type!=2,message:t("selectIconPlaceholder"),trigger:"blur"}],api_url:[{required:e.menu_type==2,message:t("authIdPlaceholder"),trigger:"blur"}]})),B=async()=>{let{data:r}=await te({});E.value=[{title:"系统",key:""}],E.value.push(...r)},L=async()=>{let{data:r}=await le();P.value=[{menu_name:"顶级",menu_key:""}],P.value.push(...r)},T=async r=>{let{data:l}=await ae(r);U.value=l},$=async r=>{e.parent_key="",r!=""&&(await T(r),e.parent_key=U.value[0].menu_key)},K=async r=>{if(_.value||!r)return;const l=e.id?X:Y;await r.validate(async(d,m)=>{if(d){_.value=!0;const s=e;s.api_url=s.api_url?`${s.api_url}/${w.value}`:"",l(s).then(g=>{_.value=!1,V.value=!1,I("complete")}).catch(()=>{_.value=!1})}})};return C({showDialog:V,setFormData:async(r=null)=>{if(_.value=!0,Object.assign(e,M),k=t("addMenu"),B(),L(),r.menu_key){k=t("updateMenu");const l=await(await ee(r.menu_key)).data;Object.keys(e).forEach(d=>{l[d]!=null&&(e[d]=l[d])}),e.addon!=""&&T(e.addon)}else Object.keys(e).forEach(l=>{r[l]!=null&&(e[l]=r[l])});_.value=!1}}),(r,l)=>{const d=oe,m=J,s=ne,g=ue,h=re,F=de,N=me,O=W,R=se,j=Q,S=pe,z=H,G=ie;return c(),b(z,{modelValue:V.value,"onUpdate:modelValue":l[17]||(l[17]=o=>V.value=o),title:u(k),width:"500px","destroy-on-close":!0},{footer:n(()=>[x("span",ge,[a(S,{onClick:l[15]||(l[15]=o=>V.value=!1)},{default:n(()=>[p(i(u(t)("cancel")),1)]),_:1}),a(S,{type:"primary",loading:_.value,onClick:l[16]||(l[16]=o=>K(D.value))},{default:n(()=>[p(i(u(t)("confirm")),1)]),_:1},8,["loading"])])]),default:n(()=>[y((c(),b(j,{model:e,"label-width":"90px",class:"page-form",ref_key:"formRef",ref:D,rules:u(q)},{default:n(()=>[a(m,{label:u(t)("menuName"),prop:"menu_name"},{default:n(()=>[a(d,{modelValue:e.menu_name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.menu_name=o),placeholder:u(t)("menuNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e.id?ye("",!0):(c(),b(m,{key:0,label:u(t)("menuKey"),prop:"menu_key"},{default:n(()=>[a(d,{modelValue:e.menu_key,"onUpdate:modelValue":l[1]||(l[1]=o=>e.menu_key=o),placeholder:u(t)("menuKeyPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),a(m,{label:u(t)("menuType")},{default:n(()=>[a(g,{modelValue:e.menu_type,"onUpdate:modelValue":l[2]||(l[2]=o=>e.menu_type=o)},{default:n(()=>[a(s,{label:0},{default:n(()=>[p(i(u(t)("menuTypeDir")),1)]),_:1}),a(s,{label:1},{default:n(()=>[p(i(u(t)("menuTypeMenu")),1)]),_:1}),a(s,{label:2},{default:n(()=>[p(i(u(t)("menuTypeButton")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(m,{label:u(t)("addon"),prop:"addon"},{default:n(()=>[a(F,{modelValue:e.addon,"onUpdate:modelValue":l[3]||(l[3]=o=>e.addon=o),placeholder:"Select",class:"input-width",onChange:$},{default:n(()=>[(c(!0),ve(be,null,Ve(E.value,(o,Z)=>(c(),b(h,{label:o.title,value:o.key,key:Z},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(m,{label:u(t)("parentMenu"),prop:"parent_key"},{default:n(()=>[e.addon!=""?(c(),b(N,{key:0,class:"input-width",modelValue:e.parent_key,"onUpdate:modelValue":l[4]||(l[4]=o=>e.parent_key=o),props:{label:"menu_name",value:"menu_key"},data:U.value,"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])):(c(),b(N,{key:1,class:"input-width",modelValue:e.parent_key,"onUpdate:modelValue":l[5]||(l[5]=o=>e.parent_key=o),props:{label:"menu_name",value:"menu_key"},data:P.value,"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"]))]),_:1},8,["label"]),y(a(m,{label:u(t)("routePath"),prop:"router_path"},{default:n(()=>[a(d,{modelValue:e.router_path,"onUpdate:modelValue":l[6]||(l[6]=o=>e.router_path=o),placeholder:u(t)("routePathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[v,e.menu_type!=2]]),y(a(m,{label:u(t)("viewPath"),prop:"view_path"},{default:n(()=>[a(d,{modelValue:e.view_path,"onUpdate:modelValue":l[7]||(l[7]=o=>e.view_path=o),placeholder:u(t)("viewPathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[v,e.menu_type==1]]),y(a(m,{label:u(t)("authId"),prop:"api_url"},{default:n(()=>[a(d,{modelValue:e.api_url,"onUpdate:modelValue":l[9]||(l[9]=o=>e.api_url=o),placeholder:u(t)("authIdPlaceholder"),class:"input-width"},{append:n(()=>[a(F,{class:"w-[90px] border-none",modelValue:w.value,"onUpdate:modelValue":l[8]||(l[8]=o=>w.value=o)},{default:n(()=>[a(h,{label:"POST",value:"post"}),a(h,{label:"GET",value:"get"}),a(h,{label:"PUT",value:"put"}),a(h,{label:"DELETE",value:"delete"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[v,e.menu_type!=0]]),y(a(m,{label:u(t)("menuIcon"),prop:"icon"},{default:n(()=>[x("div",he,[a(O,{modelValue:e.icon,"onUpdate:modelValue":l[10]||(l[10]=o=>e.icon=o)},null,8,["modelValue"])])]),_:1},8,["label"]),[[v,e.menu_type!=2]]),y(a(m,{label:u(t)("status")},{default:n(()=>[a(g,{modelValue:e.status,"onUpdate:modelValue":l[11]||(l[11]=o=>e.status=o)},{default:n(()=>[a(s,{label:1},{default:n(()=>[p(i(u(t)("statusNormal")),1)]),_:1}),a(s,{label:0},{default:n(()=>[p(i(u(t)("statusDeactivate")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[v,e.menu_type!=2]]),y(a(m,{label:u(t)("isShow")},{default:n(()=>[a(g,{modelValue:e.is_show,"onUpdate:modelValue":l[12]||(l[12]=o=>e.is_show=o)},{default:n(()=>[a(s,{label:1},{default:n(()=>[p(i(u(t)("show")),1)]),_:1}),a(s,{label:0},{default:n(()=>[p(i(u(t)("hidden")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[v,e.menu_type!=2]]),a(m,{label:u(t)("menuShortName")},{default:n(()=>[a(d,{modelValue:e.menu_short_name,"onUpdate:modelValue":l[13]||(l[13]=o=>e.menu_short_name=o),placeholder:u(t)("menuShortNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(m,{label:u(t)("sort")},{default:n(()=>[a(R,{modelValue:e.sort,"onUpdate:modelValue":l[14]||(l[14]=o=>e.sort=o),min:0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[G,_.value]])]),_:1},8,["modelValue","title"])}}});export{Xe as _};
