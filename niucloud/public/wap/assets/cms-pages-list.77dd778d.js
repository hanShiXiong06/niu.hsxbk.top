import{A as e,B as a,C as t,aG as l,q as o,t as r,i as s,j as c,w as i,k as n,p as u,F as d,G as h,H as p,m,D as f,E as y,I as g,x as b,a6 as _,d as x,r as k,o as v,K as w,aH as C,n as S,aI as I,P as j,Q as $,R as A,a9 as z,aa as B,a7 as T,y as V,e as F}from"./index-c8487b3e.js";import{_ as U}from"./u-icon.e1505caa.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as H}from"./u--image.bde6b800.js";import{_ as N}from"./tabbar.7b0b1965.js";import{g as D,a as E}from"./article.d8d2f7d6.js";import{u as G,M as R}from"./useMescroll.16a36445.js";import{M as K}from"./mescroll-empty.e6398411.js";import{u as O}from"./useShare.5d05b805.js";import"./u-image.9b57fa1f.js";import"./u-transition.75acc538.js";import"./u-badge.97e4ae5b.js";import"./u-tabbar.44cf5e15.js";import"./u-safe-bottom.f4b61f4d.js";/* empty css                                                                       */import"./wechat.8ecaae3c.js";const P=M({name:"u-search",mixins:[a,t,{props:{shape:{type:String,default:e.search.shape},bgColor:{type:String,default:e.search.bgColor},placeholder:{type:String,default:e.search.placeholder},clearabled:{type:Boolean,default:e.search.clearabled},focus:{type:Boolean,default:e.search.focus},showAction:{type:Boolean,default:e.search.showAction},actionStyle:{type:Object,default:e.search.actionStyle},actionText:{type:String,default:e.search.actionText},inputAlign:{type:String,default:e.search.inputAlign},inputStyle:{type:Object,default:e.search.inputStyle},disabled:{type:Boolean,default:e.search.disabled},borderColor:{type:String,default:e.search.borderColor},searchIconColor:{type:String,default:e.search.searchIconColor},color:{type:String,default:e.search.color},placeholderColor:{type:String,default:e.search.placeholderColor},searchIcon:{type:String,default:e.search.searchIcon},searchIconSize:{type:[Number,String],default:e.search.searchIconSize},margin:{type:String,default:e.search.margin},animation:{type:Boolean,default:e.search.animation},modelValue:{type:String,default:e.search.value},value:{type:String,default:e.search.value},maxlength:{type:[String,Number],default:e.search.maxlength},height:{type:[String,Number],default:e.search.height},label:{type:[String,Number,null],default:e.search.label}}}],data(){return{keyword:"",showClear:!1,show:!1,focused:this.focus}},watch:{keyword(e){this.$emit("update:modelValue",e),this.$emit("change",e)},modelValue:{immediate:!0,handler(e){this.keyword=e}}},computed:{showActionBtn(){return!this.animation&&this.showAction}},emits:["clear","search","custom","focus","blur","click","clickIcon","update:modelValue","change"],methods:{inputChange(e){this.keyword=e.detail.value},clear(){this.keyword="",this.$nextTick((()=>{this.$emit("clear")}))},search(e){this.$emit("search",e.detail.value);try{l()}catch(a){}},custom(){this.$emit("custom",this.keyword);try{l()}catch(e){}},getFocus(){this.focused=!0,this.animation&&this.showAction&&(this.show=!0),this.$emit("focus",this.keyword)},blur(){setTimeout((()=>{this.focused=!1}),100),this.show=!1,this.$emit("blur",this.keyword)},clickHandler(){this.disabled&&this.$emit("click")},clickIcon(){this.$emit("clickIcon")}}},[["render",function(e,a,t,l,x,k){const v=g,w=o(r("u-icon"),U),C=b,S=_;return s(),c(C,{class:"u-search",onClick:k.clickHandler,style:u([{margin:e.margin},e.$u.addStyle(e.customStyle)])},{default:i((()=>[n(C,{class:"u-search__content",style:u({backgroundColor:e.bgColor,borderRadius:"round"==e.shape?"100px":"4px",borderColor:e.borderColor})},{default:i((()=>[e.$slots.label||null!==e.label?d(e.$slots,"label",{key:0},(()=>[n(v,{class:"u-search__content__label"},{default:i((()=>[h(p(e.label),1)])),_:1})]),!0):m("v-if",!0),n(C,{class:"u-search__content__icon"},{default:i((()=>[n(w,{onClick:k.clickIcon,size:e.searchIconSize,name:e.searchIcon,color:e.searchIconColor?e.searchIconColor:e.color},null,8,["onClick","size","name","color"])])),_:1}),n(S,{"confirm-type":"search",onBlur:k.blur,value:x.keyword,onConfirm:k.search,onInput:k.inputChange,disabled:e.disabled,onFocus:k.getFocus,focus:e.focus,maxlength:e.maxlength,"placeholder-class":"u-search__content__input--placeholder",placeholder:e.placeholder,"placeholder-style":`color: ${e.placeholderColor}`,class:"u-search__content__input",type:"text",style:u([{textAlign:e.inputAlign,color:e.color,backgroundColor:e.bgColor,height:e.$u.addUnit(e.height)},e.inputStyle])},null,8,["onBlur","value","onConfirm","onInput","disabled","onFocus","focus","maxlength","placeholder","placeholder-style","style"]),x.keyword&&e.clearabled&&x.focused?(s(),c(C,{key:1,class:"u-search__content__icon u-search__content__close",onClick:k.clear},{default:i((()=>[n(w,{name:"close",size:"11",color:"#ffffff",customStyle:"line-height: 12px"})])),_:1},8,["onClick"])):m("v-if",!0)])),_:3},8,["style"]),n(v,{style:u([e.actionStyle]),class:f(["u-search__action",[(k.showActionBtn||x.show)&&"u-search__action--active"]]),onClick:y(k.custom,["stop","prevent"])},{default:i((()=>[h(p(e.actionText),1)])),_:1},8,["style","class","onClick"])])),_:3},8,["onClick","style"])}],["__scopeId","data-v-7ec77839"]]),q=M(x({__name:"list",setup(e){const{mescrollInit:a,downCallback:t,getMescroll:l}=G(B,z),{setShare:u,onShareAppMessage:d,onShareTimeline:y}=O();u(),d(),y();let _=k([]),x=k([]),M=k(""),q=k(""),J=k(null),Q=k(!1);v((async()=>{await D().then((e=>{const a={name:w("all"),category_id:""};_.value.push(a),_.value=_.value.concat(e.data.data)}))}));const W=e=>{Q.value=!1;let a={category_id:M.value,title:q.value,page:e.num,limit:e.size};E(a).then((a=>{let t=a.data.data;1==e.num&&(x.value=[]),x.value=x.value.concat(t),e.endSuccess(t.length),Q.value=!0})).catch((()=>{Q.value=!0,e.endErr()}))},L=()=>{l().resetUpScroll()};return C((()=>{setTimeout((()=>{l().optUp.textNoMore=w("end")}),500)})),(e,u)=>{const d=o(r("u-search"),P),y=b,k=T,v=o(r("u-icon"),U),C=o(r("u--image"),H),z=g,B=o(r("tabbar"),N);return s(),c(y,{class:"bg-gray-100 min-h-[100vh]"},{default:i((()=>[n(y,{class:"fixed top-0 inset-x-0 z-10"},{default:i((()=>[n(y,{class:"p-[10px] bg-white border-solid border-t-0 border-l-0 border-r-0 border-b-[1px] border-gray-200"},{default:i((()=>[n(d,{placeholder:S(w)("searchPlaceholder"),actionText:"",actionStyle:{width:0,margin:0},modelValue:S(q),"onUpdate:modelValue":u[0]||(u[0]=e=>I(q)?q.value=e:q=e),onClickIcon:L},null,8,["placeholder","modelValue"])])),_:1}),n(k,{"scroll-x":!0,"enable-flex":!0,class:"nav-list bg-white align-center px-[10px] box-border"},{default:i((()=>[n(y,{class:"flex scroll-view-wrap"},{default:i((()=>[(s(!0),j(A,null,$(S(_),((e,a)=>(s(),c(y,{class:f(["nav-item text-[14px] mx-[5px] h-[30px] leading-[30px] my-[5px] border-t-0 border-l-0 border-r-0",{"border-solid border-b-[2px] active":S(M)==e.category_id}]),onClick:a=>{return t=e.category_id,M.value=t,void l().resetUpScroll();var t},key:e.category_id},{default:i((()=>[h(p(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),n(R,{ref_key:"mescrollRef",ref:J,onInit:S(a),top:"220rpx",onDown:S(t),onUp:W},{default:i((()=>[(s(!0),j(A,null,$(S(x),((e,a)=>(s(),c(y,{key:e.id,class:f(["bg-white flex align-center p-[10px]",{"border-solid border-t-0 border-l-0 border-r-0 border-b-[1px] border-gray-200":S(x).length-1!==a}]),onClick:a=>{return t=e.id,void F({url:"/cms/pages/detail",param:{id:t}});var t}},{default:i((()=>[n(C,{width:"174rpx",height:"174rpx",src:S(V)(e.image),model:"aspectFill"},{error:i((()=>[n(v,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),n(y,{class:"flex-1 flex flex-col justify-between ml-[10px]"},{default:i((()=>[n(y,{class:"text-[16px] leading-[1.3] multi-hidden mt-[2px]"},{default:i((()=>[h(p(e.title),1)])),_:2},1024),n(y,{class:"text-[14px] using-hidden mb-[10px] mt-[10px] text-gray-500"},{default:i((()=>[h(p(e.summary),1)])),_:2},1024),n(y,{class:"text-[12px] text-gray-400 flex justify-between mb-[5px]"},{default:i((()=>[n(z,{class:""},{default:i((()=>[h(p(e.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),!S(x).length&&S(Q)?(s(),c(K,{key:0})):m("v-if",!0)])),_:1},8,["onInit","onDown"]),n(B)])),_:1})}}}),[["__scopeId","data-v-450b3cff"]]);export{q as default};
