import{d as a,r as t,o as e,s,K as l,i as r,P as o,j as u,w as p,k as c,n,G as i,H as m,m as x,R as d,e as f,aA as y,W as _,x as v,I as g,q as j,t as w,y as b,a2 as h}from"./index-c8487b3e.js";import{_ as T}from"./u-button.a3ccbdc0.js";import{_ as k}from"./u-loading-icon.92d47c06.js";import{_ as S}from"./u-modal.98f8c892.js";import{g as C}from"./pay.116f472c.js";import{_ as F}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.e1505caa.js";import"./u-line.2476104f.js";import"./u-popup.41f7f1c4.js";import"./u-transition.75acc538.js";import"./u-safe-bottom.f4b61f4d.js";const P=F(a({__name:"result",setup(a){const F=t(null),P=t(!1);let R="",I=0,E=0;e((a=>{R=a.trade_type,I=a.trade_id,q()}));const q=()=>{C(R,I).then((a=>{if(!uni.$u.test.isEmpty(a.data)){if(1==a.data.status&&E<5)return P.value=!0,E++,void setTimeout((()=>{q()}),1e3);F.value=a.data,P.value=!1,s({title:2==F.value.status?l("pay.paySuccess"):l("pay.payFail")})}})).catch((()=>{}))},z=()=>{var a;const t=decodeURIComponent(uni.getStorageSync("payReturn"));f(t?{url:t,mode:"redirectTo"}:{url:y(),param:{code:null==(a=F.value)?void 0:a.out_trade_no},mode:"redirectTo"})};return(a,t)=>{const e=_,s=v,f=g,y=j(w("u-button"),T),C=j(w("u-loading-icon"),k),R=j(w("u-modal"),S);return r(),o(d,null,[F.value?(r(),u(s,{key:0,class:"w-screen bg-[#fff] flex flex-col items-center"},{default:p((()=>[c(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:p((()=>[2==F.value.status?(r(),u(e,{key:0,class:"max-w-[144rpx] max-h-[88rpx]",src:n(b)("static/resource/images/result/pay_succeed.png")},null,8,["src"])):(r(),u(e,{key:1,class:"max-w-[144rpx] max-h-[88rpx]",src:n(b)("static/resource/images/result/pay_error.png")},null,8,["src"])),c(s,{class:"text-[32rpx] font-bold mt-[22rpx]"},{default:p((()=>[i(m(2==F.value.status?n(l)("pay.paySuccess"):n(l)("pay.payFail")),1)])),_:1}),c(s,{class:"text-[40rpx] font-bold mt-[40rpx] text-[#FF4646]"},{default:p((()=>[c(f,{class:"text-base"},{default:p((()=>[i(m(n(l)("currency")),1)])),_:1}),c(f,null,{default:p((()=>[i(m(n(h)(F.value.money)),1)])),_:1})])),_:1})])),_:1}),c(s,{class:"pb-[80rpx] pt-[40rpx] w-[240rpx]"},{default:p((()=>[c(y,{type:"primary",text:2==F.value.status?n(l)("complete"):n(l)("close"),plain:!0,onClick:z},null,8,["text"])])),_:1})])),_:1})):x("v-if",!0),c(R,{show:P.value,showCancelButton:!0,confirmText:n(l)("pay.completePay"),cancelText:n(l)("pay.incompletePay"),onCancel:z},{default:p((()=>[c(s,{class:"py-[20rpx]"},{default:p((()=>[c(C,{text:n(l)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])],64)}}}),[["__scopeId","data-v-660223a9"]]);export{P as default};
