import{d as a,r as t,o as e,s,H as l,e as o,z as u,f as r,w as n,h as c,I as i,x as p,y as m,j as x,B as d,F as f,N as y,aY as _,G as v,m as j,k as h,l as w,aw as b}from"./index-b8ec63bc.js";import{_ as g}from"./u-button.0fab1ad6.js";import{_ as T}from"./u-loading-icon.1f177a88.js";import{_ as z}from"./u-modal.c86a68c4.js";import{g as k}from"./pay.89ccd231.js";import"./u-icon.45222ba8.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.17f02c8e.js";import"./u-popup.d867344c.js";import"./u-transition.eb56da8c.js";import"./u-safe-bottom.c00f6ea6.js";const C=a({__name:"result",setup(a){const C=t(null),F=t(!1);let S="",B=0;e((a=>{S=a.code,N()}));const N=()=>{k(S).then((a=>{if(!uni.$u.test.isEmpty(a.data)){if(1==a.data.status&&B<5)return F.value=!0,B++,void setTimeout((()=>{N()}),1e3);C.value=a.data,F.value=!1,s({title:2==C.value.status?l("pay.paySuccess"):l("pay.payFail")})}})).catch((()=>{}))},P=()=>{var a;y({url:_(),param:{code:null==(a=C.value)?void 0:a.out_trade_no},mode:"redirectTo"})};return(a,t)=>{const e=v,s=j,y=h(w("u-button"),g),_=h(w("u-loading-icon"),T),k=h(w("u-modal"),z);return o(),u(f,null,[C.value?(o(),r(s,{key:0,class:"w-screen h-screen flex flex-col items-center"},{default:n((()=>[c(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:n((()=>[c(e,{class:i(["iconfont text-2xl",2==C.value.status?"text-primary iconduigou":"iconzhifushibai text-red"])},null,8,["class"]),c(s,{class:"text-sm"},{default:n((()=>[p(m(2==C.value.status?x(l)("pay.paySuccess"):x(l)("pay.payFail")),1)])),_:1}),c(s,{class:"text-xl font-bold pt-[30rpx]"},{default:n((()=>[c(e,{class:"text-base"},{default:n((()=>[p(m(x(l)("currency")),1)])),_:1}),c(e,null,{default:n((()=>[p(m(x(b)(C.value.money)),1)])),_:1})])),_:1})])),_:1}),c(s,{class:"pb-[200rpx] w-[240rpx]"},{default:n((()=>[c(y,{type:"primary",text:2==C.value.status?x(l)("complete"):x(l)("close"),plain:!0,onClick:P},null,8,["text"])])),_:1})])),_:1})):d("",!0),c(k,{show:F.value,showCancelButton:!0,confirmText:x(l)("pay.completePay"),cancelText:x(l)("pay.incompletePay"),onCancel:P},{default:n((()=>[c(s,{class:"py-[20rpx]"},{default:n((()=>[c(_,{text:x(l)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])],64)}}});export{C as default};
