import{d as t,r as a,o as e,s,G as l,e as o,K as u,f as r,w as n,h as c,D as i,A as p,B as m,j as d,C as f,M as x,P as y,b8 as _,F as v,m as j,k as h,l as b,ar as g}from"./index-5ccb7aca.js";import{_ as w}from"./u-button.092119b5.js";import{_ as T}from"./u-loading-icon.5a04567d.js";import{_ as C}from"./u-modal.276d8a5f.js";import{g as S}from"./pay.1f709bf2.js";import"./u-icon.b7c42932.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.6a74bc71.js";import"./u-popup.bc41148f.js";import"./u-transition.d4c1e034.js";import"./u-safe-bottom.1d02e76a.js";const k=t({__name:"result",setup(t){const k=a(null),F=a(!1);let P="",z=0;e((t=>{P=t.code,B()}));const B=()=>{S(P).then((t=>{if(!uni.$u.test.isEmpty(t.data)){if(1==t.data.status&&z<5)return F.value=!0,z++,void setTimeout((()=>{B()}),1e3);k.value=t.data,F.value=!1,s({title:2==k.value.status?l("pay.paySuccess"):l("pay.payFail")})}})).catch((()=>{}))},A=()=>{var t;y({url:_(),param:{code:null==(t=k.value)?void 0:t.out_trade_no},mode:"redirectTo"})};return(t,a)=>{const e=v,s=j,y=h(b("u-button"),w),_=h(b("u-loading-icon"),T),S=h(b("u-modal"),C);return o(),u(x,null,[k.value?(o(),r(s,{key:0,class:"w-screen h-screen flex flex-col items-center"},{default:n((()=>[c(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:n((()=>[c(e,{class:i(["iconfont text-2xl",2==k.value.status?"text-primary iconduigou":"iconzhifushibai text-red"])},null,8,["class"]),c(s,{class:"text-sm"},{default:n((()=>[p(m(2==k.value.status?d(l)("pay.paySuccess"):d(l)("pay.payFail")),1)])),_:1}),c(s,{class:"text-xl font-bold pt-[30rpx]"},{default:n((()=>[c(e,{class:"text-base"},{default:n((()=>[p(m(d(l)("currency")),1)])),_:1}),c(e,null,{default:n((()=>[p(m(d(g)(k.value.money)),1)])),_:1})])),_:1})])),_:1}),c(s,{class:"pb-[200rpx] w-[240rpx]"},{default:n((()=>[c(y,{type:"primary",text:2==k.value.status?d(l)("complete"):d(l)("close"),plain:!0,onClick:A},null,8,["text"])])),_:1})])),_:1})):f("",!0),c(S,{show:F.value,showCancelButton:!0,confirmText:d(l)("pay.completePay"),cancelText:d(l)("pay.incompletePay"),onCancel:A},{default:n((()=>[c(s,{class:"py-[20rpx]"},{default:n((()=>[c(_,{text:d(l)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])],64)}}});export{k as default};
