import{d as e,ag as a,r as t,ar as l,h as r,q as s,t as n,i as o,j as u,w as p,k as c,K as i,L as d,n as m,Z as y,ak as _,F as f,G as v,H as g,y as x,m as b,aa as h,x as k,ap as S,Y as w,a as C,e as j,as as I,aj as E,l as F,v as T,p as R,aq as O,M as P,N as U}from"./index-aafd04f6.js";import{_ as A}from"./u-loading-page.117dc94e.js";import{_ as H}from"./u-button.7a78cac5.js";import{_ as q}from"./u-image.516d0eb3.js";import{_ as L}from"./u-icon.0ce29e5a.js";import{_ as M}from"./u-popup.2be273f7.js";import{p as N,g as Z}from"./pay.2807685a.js";import{w as $}from"./wechat.f4ddca86.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.660c9bdb.js";import"./u-transition.14e36316.js";import"./u-safe-bottom.1659b859.js";const B=z(e({__name:"pay",emits:["close"],setup(e,{expose:w,emit:C}){a()&&$.init();const j=t(!1),I=t(!1),E=t(null),F=t(""),T=()=>{var e,t;uni.$u.test.isEmpty(F.value)?h({title:y("pay.notHavePayType"),icon:"none"}):I.value||(I.value=!0,N({trade_type:null==(e=E.value)?void 0:e.trade_type,trade_id:null==(t=E.value)?void 0:t.trade_id,type:F.value}).then((e=>{var t,l,s,n,o,u;switch(F.value){case"wechatpay":a()?(e.data.timestamp=e.data.timeStamp,delete e.data.timeStamp,$.pay({...e.data,success:()=>{R()},cancel:()=>{I.value=!1}})):(uni.setStorageSync("paymenting",{trade_type:null==(t=E.value)?void 0:t.trade_type,trade_id:null==(l=E.value)?void 0:l.trade_id}),location.href=e.data.h5_url);break;case"alipay":a()?r({url:"/app/pages/pay/browser",param:{trade_type:null==(s=E.value)?void 0:s.trade_type,trade_id:null==(n=E.value)?void 0:n.trade_id,alipay:encodeURIComponent(e.data.url)},mode:"redirectTo"}):(uni.setStorageSync("paymenting",{trade_type:null==(o=E.value)?void 0:o.trade_type,trade_id:null==(u=E.value)?void 0:u.trade_id}),location.href=e.data.url);break;default:R()}})).catch((()=>{I.value=!1})))};l("checkIsReturnAfterPayment",(()=>{const e=uni.getStorageSync("paymenting");uni.getStorageSync("paymenting")&&r({url:"/app/pages/pay/result",param:{trade_type:e.trade_type,trade_id:e.trade_id},mode:"redirectTo",success(){uni.removeStorageSync("paymenting")}})}));const R=()=>{var e,a;r({url:"/app/pages/pay/result",param:{trade_type:null==(e=E.value)?void 0:e.trade_type,trade_id:null==(a=E.value)?void 0:a.trade_id},mode:"redirectTo"})},O=()=>{uni.removeStorageSync("paymenting"),j.value=!1;const e=decodeURIComponent(uni.getStorageSync("payReturn"));e&&r({url:e,mode:"redirectTo"}),C("close")};return w({open:(e,a,t="")=>{uni.setStorageSync("payReturn",encodeURIComponent(t)),Z(e,a).then((e=>{let{data:a}=e;E.value=a,uni.$u.test.isEmpty(a)?h({title:y("pay.notObtainedInfo"),icon:"none"}):0!=a.money?0==a.status?(F.value=a.pay_type_list[0]?a.pay_type_list[0].key:"",j.value=!0):h({title:y("pay.paymentDocuments")+a.status_name,icon:"none"}):R()})).catch((()=>{}))}}),(e,a)=>{const t=k,l=s(n("u-image"),q),r=s(n("u-icon"),L),h=S,w=s(n("u-button"),H),C=s(n("u-popup"),M);return o(),u(C,{show:j.value,round:10,onClose:O,closeable:!0,bgColor:"#fff",zIndex:"10081",closeOnClickOverlay:!1},{default:p((()=>[E.value?(o(),u(t,{key:0,class:"flex flex-col h-[75vh]"},{default:p((()=>[c(t,{class:"head"},{default:p((()=>[c(t,{class:"text-center py-[26rpx]"},{default:p((()=>[i(d(m(y)("pay.payTitle")),1)])),_:1}),c(t,{class:"flex items-end justify-center w-full text-xl font-bold py-[20rpx]"},{default:p((()=>[c(t,{class:"text-base mr-[4rpx]"},{default:p((()=>[i(d(m(y)("currency")),1)])),_:1}),i(" "+d(m(_)(E.value.money)),1)])),_:1})])),_:1}),c(h,{"scroll-y":"true",class:"flex-1 pt-[20rpx]"},{default:p((()=>[c(t,{class:"flex text-sm px-[30rpx] py-[20rpx]"},{default:p((()=>[c(t,{class:"text-gray-500"},{default:p((()=>[i(d(m(y)("pay.orderInfo")),1)])),_:1}),c(t,{class:"text-right flex-1 pl-[30rpx] truncate"},{default:p((()=>[i(d(E.value.body),1)])),_:1})])),_:1}),c(t,{class:"mx-[30rpx] py-[10rpx] px-[30rpx] bg-white rounded-md bg-page"},{default:p((()=>[E.value.pay_type_list.length?(o(!0),f(v,{key:0},g(E.value.pay_type_list,((e,a)=>(o(),u(t,{class:"pay-item py-[18rpx] flex items-center border-0 border-b border-solid border-[#eee]",key:a,onClick:a=>F.value=e.key},{default:p((()=>[c(l,{src:m(x)(e.icon),width:"50rpx",height:"50rpx"},null,8,["src"]),c(t,{class:"flex-1 px-[20rpx] text-sm font-bold"},{default:p((()=>[i(d(e.name),1)])),_:2},1024),e.key==F.value?(o(),u(r,{key:0,name:"checkbox-mark",color:"var(--primary-color)"})):b("v-if",!0)])),_:2},1032,["onClick"])))),128)):(o(),u(t,{key:1,class:"py-[20rpx] text-center text-sm text-gray-subtitle"},{default:p((()=>[i(d(m(y)("pay.notHavePayType")),1)])),_:1}))])),_:1})])),_:1}),c(t,{class:"p-[30rpx]"},{default:p((()=>[c(w,{type:"primary",loading:I.value,text:m(y)("pay.confirmPay"),shape:"circle",onClick:T},null,8,["loading","text"])])),_:1})])),_:1})):b("v-if",!0)])),_:1},8,["show"])}}}),[["__scopeId","data-v-4fc9a620"]]),D=z(e({__name:"balance",setup(e){const a=w(),l=t(!1),g=t(null),h=C({is_auto_transfer:0,is_auto_verify:0,is_open:0,min:0,rate:0,transfer_type:[]}),S=t(!0);j((()=>{I("checkIsReturnAfterPayment"),E().then((e=>{for(let a in e.data)h[a]=e.data[a];S.value=!1}))}));const q=()=>{O("cashOutAccountType","money"),r({url:"/app/pages/member/apply_cash_out"})};return(e,t)=>{const w=s(n("u-loading-page"),A),C=k,j=P,I=U,E=s(n("u-button"),H),O=s(n("pay"),B);return o(),f(v,null,[c(w,{loading:S.value,loadingText:""},null,8,["loading"]),F(c(C,{class:"account-info-wrap"},{default:p((()=>[c(C,{class:"account-info-head",style:R({background:"url("+m(x)("static/resource/images/member/balance_bg.png")+") no-repeat 95% 30% / auto 250rpx, linear-gradient(314deg, #FE7849 0%, #FF1959 100%)"})},{default:p((()=>[c(C,{class:"name"},{default:p((()=>[i(d(m(y)("balanceInfo")),1)])),_:1}),c(C,{class:"content"},{default:p((()=>[c(C,{class:"money"},{default:p((()=>[i(d(m(a).info?m(_)((parseFloat(m(a).info.balance)+parseFloat(m(a).info.money)).toString()):"0.00"),1)])),_:1}),c(C,{class:"text"},{default:p((()=>[i(d(m(y)("accountBalance")),1)])),_:1}),c(C,{class:"money-wrap"},{default:p((()=>[c(C,{class:"money-item",onClick:t[0]||(t[0]=e=>m(r)({url:"/app/pages/member/detailed_account",param:{type:"balance"}}))},{default:p((()=>[c(C,{class:"money"},{default:p((()=>{var e;return[i(d(m(_)(null==(e=m(a).info)?void 0:e.balance)||"0.00"),1)]})),_:1}),c(C,{class:"text leading-none"},{default:p((()=>[i(d(m(y)("balance")),1)])),_:1})])),_:1}),c(C,{class:"money-item",onClick:t[1]||(t[1]=e=>m(r)({url:"/app/pages/member/detailed_account",param:{type:"money"}}))},{default:p((()=>[c(C,{class:"money"},{default:p((()=>{var e;return[i(d(m(_)(null==(e=m(a).info)?void 0:e.money)||"0.00"),1)]})),_:1}),c(C,{class:"text leading-none"},{default:p((()=>[i(d(m(y)("money")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),c(C,{class:"account-info-btn"},{default:p((()=>[b(' <u-button type="primary" shape="circle" class="btn"\r\n\t\t\t\t:customStyle="{backgroundColor: \'#FE4E50\',color: \'#fff\', borderColor: \'#FE4E50\',width: \'calc(100vw - 64rpx)\'}"\r\n\t\t\t\t@click="topUpFn">\r\n\t\t\t\t<image class="max-w-[36rpx] max-h-[36rpx] mr-1" :src="img(\'static/resource/images/member/reset.png\')"/>\r\n\t\t\t\t<text>{{t(\'recharge\')}}</text>\r\n\t\t\t</u-button> '),1==h.is_open?(o(),u(E,{key:0,type:"primary",plain:!0,shape:"circle",class:"btn",customStyle:{backgroundColor:"#fff",color:"#FE4E50",borderColor:"#FE4E50",width:"calc(100vw - 64rpx)"},onClick:q},{default:p((()=>[c(j,{class:"max-w-[36rpx] max-h-[36rpx] mr-1",src:m(x)("static/resource/images/member/withdraw_deposit.png")},null,8,["src"]),c(I,null,{default:p((()=>[i(d(m(y)("cashOut")),1)])),_:1})])),_:1},8,["customStyle"])):b("v-if",!0)])),_:1}),c(O,{ref_key:"payRef",ref:g,onClose:t[2]||(t[2]=e=>l.value=!1)},null,512)])),_:1},512),[[T,!S.value]])],64)}}}),[["__scopeId","data-v-1495d8e2"]]);export{D as default};
