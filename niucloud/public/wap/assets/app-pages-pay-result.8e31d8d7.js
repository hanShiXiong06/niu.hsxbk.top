import{d as e,r as a,o as t,s,Z as l,i as r,F as o,j as u,w as p,k as c,n,K as i,L as m,m as x,G as d,e as f,b8 as y,M as _,x as v,N as g,q as j,t as b,y as w,aj as h}from"./index-42b5dd66.js";import{_ as T}from"./u-button.611a1b81.js";import{_ as S}from"./u-loading-icon.677af9c0.js";import{_ as k}from"./u-modal.b8d44c35.js";import{g as F}from"./pay.18eabc5e.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.d822f266.js";import"./u-line.9c8e4680.js";import"./u-popup.7c4d4b2a.js";import"./u-transition.58dbc541.js";import"./u-safe-bottom.6809b39f.js";const R=C(e({__name:"result",setup(e){const C=a(null),R=a(!1);let I="",P=0,U=0;t((e=>{I=e.trade_type,P=e.trade_id,Z()}));const Z=()=>{F(I,P).then((e=>{if(!uni.$u.test.isEmpty(e.data)){if(1==e.data.status&&U<5)return R.value=!0,U++,void setTimeout((()=>{Z()}),1e3);C.value=e.data,R.value=!1,s({title:2==C.value.status?l("pay.paySuccess"):l("pay.payFail")})}})).catch((()=>{}))},q=()=>{var e;const a=decodeURIComponent(uni.getStorageSync("payReturn"));f(a?{url:a,mode:"redirectTo"}:{url:y(),param:{code:null==(e=C.value)?void 0:e.out_trade_no},mode:"redirectTo"})};return(e,a)=>{const t=_,s=v,f=g,y=j(b("u-button"),T),F=j(b("u-loading-icon"),S),I=j(b("u-modal"),k);return r(),o(d,null,[C.value?(r(),u(s,{key:0,class:"w-screen bg-[#fff] flex flex-col items-center"},{default:p((()=>[c(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:p((()=>[2==C.value.status?(r(),u(t,{key:0,class:"max-w-[144rpx] max-h-[88rpx]",src:n(w)("static/resource/images/result/pay_succeed.png")},null,8,["src"])):(r(),u(t,{key:1,class:"max-w-[144rpx] max-h-[88rpx]",src:n(w)("static/resource/images/result/pay_error.png")},null,8,["src"])),c(s,{class:"text-[32rpx] font-bold mt-[22rpx]"},{default:p((()=>[i(m(2==C.value.status?n(l)("pay.paySuccess"):n(l)("pay.payFail")),1)])),_:1}),c(s,{class:"text-[40rpx] font-bold mt-[40rpx] text-[#FF4646]"},{default:p((()=>[c(f,{class:"text-base"},{default:p((()=>[i(m(n(l)("currency")),1)])),_:1}),c(f,null,{default:p((()=>[i(m(n(h)(C.value.money)),1)])),_:1})])),_:1})])),_:1}),c(s,{class:"pb-[80rpx] pt-[40rpx] w-[240rpx]"},{default:p((()=>[c(y,{type:"primary",text:2==C.value.status?n(l)("complete"):n(l)("close"),plain:!0,onClick:q},null,8,["text"])])),_:1})])),_:1})):x("v-if",!0),c(I,{show:R.value,showCancelButton:!0,confirmText:n(l)("pay.completePay"),cancelText:n(l)("pay.incompletePay"),onCancel:q},{default:p((()=>[c(s,{class:"py-[20rpx]"},{default:p((()=>[c(F,{text:n(l)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])],64)}}}),[["__scopeId","data-v-03e1fe0c"]]);export{R as default};
