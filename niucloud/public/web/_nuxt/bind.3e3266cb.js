import{E as x}from"./el-input.695ad1b0.js";import{E as B,a as R}from"./el-overlay.d34bed94.js";import{u as q,t as I,_ as P}from"./test.5fa42c56.js";import{E as S}from"./el-button.41e73ba9.js";import{a as F,b as N,e as h,r as f,f as U,h as j,o as D,i as L,j as u,t as v,u as n,k as t,l as a,w as i,m as M,p as T,q as $}from"./entry.08c6ab45.js";import{u as z}from"./useLogin.f8a66f0c.js";import{_ as A}from"./_plugin-vue_export-helper.c27b6911.js";import"./use-form-item.7dcbf65b.js";import"./index.34f12059.js";import"./vnode.7865e18e.js";import"./throttle.d003d777.js";import"./debounce.3db11f73.js";import"./system.6cdccf49.js";const G={class:"w-full h-full bg-page flex items-center justify-center"},H={class:"flex bg-white"},J={class:"bg-white w-[380px] p-[30px]"},K={class:"flex items-end mb-[30px] mt-[15px]"},O={class:"mr-[20px] text-base cursor-pointer leading-none font-bold"},Q=F({__name:"bind",setup(W){const _=N(),y=h(()=>_.info),r=f(!1),l=U({mobile:"",mobile_code:"",mobile_key:"",openid:j("openId").value}),k=h(()=>({mobile:[{type:"string",required:!0,message:t("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,o,m){return I.mobile(o)},message:t("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:t("codePlaceholder"),trigger:["blur","change"]}})),c=f(),V=async()=>{var e;await((e=c.value)==null?void 0:e.validate(async(o,m)=>{if(o){if(r.value)return;r.value=!0,(y.value?T:$)(l).then(p=>{_.setToken(p.data.token),z().handleLoginBack()}).catch(()=>{r.value=!1,b.refresh()})}}))},b=q(l);b.refresh();const g=f(null),w=async()=>{var e;await((e=c.value)==null?void 0:e.validateField("mobile",async(o,m)=>{var s;o&&((s=g.value)==null||s.send())}))};return(e,o)=>{const m=x,s=B,p=P,C=S,E=R;return D(),L("div",G,[u("div",H,[u("div",J,[u("div",K,[u("div",O,v(("t"in e?e.t:n(t))("mobileBind")),1)]),a(E,{model:l,ref_key:"formRef",ref:c,rules:n(k),"validate-on-rule-change":!1},{default:i(()=>[u("div",null,[a(s,{prop:"mobile"},{default:i(()=>[a(m,{modelValue:l.mobile,"onUpdate:modelValue":o[0]||(o[0]=d=>l.mobile=d),placeholder:("t"in e?e.t:n(t))("mobilePlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),_:1}),a(s,{prop:"mobile_code"},{default:i(()=>[a(m,{modelValue:l.mobile_code,"onUpdate:modelValue":o[2]||(o[2]=d=>l.mobile_code=d),placeholder:("t"in e?e.t:n(t))("codePlaceholder")},{suffix:i(()=>[a(p,{mobile:l.mobile,type:"login",modelValue:l.mobile_key,"onUpdate:modelValue":o[1]||(o[1]=d=>l.mobile_key=d),onClick:w,ref_key:"smsCodeRef",ref:g},null,8,["mobile","modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1})]),a(s,null,{default:i(()=>[a(C,{type:"primary",class:"mt-[20px] w-full",size:"large",onClick:V,loading:r.value},{default:i(()=>[M(v(r.value?("t"in e?e.t:n(t))("binding"):("t"in e?e.t:n(t))("bind")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])])])}}});const de=A(Q,[["__scopeId","data-v-693f19ae"]]);export{de as default};
